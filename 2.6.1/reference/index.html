
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../how-to-guides/">
      
      
        <link rel="next" href="../explanation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Reference - Joseki documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#joseki.accessor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Joseki documentation" class="md-header__button md-logo" aria-label="Joseki documentation" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Joseki documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/rayference/joseki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Joseki documentation" class="md-nav__button md-logo" aria-label="Joseki documentation" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    Joseki documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rayference/joseki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How-to Guides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#joseki.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      accessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="accessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor" class="md-nav__link">
    <span class="md-ellipsis">
      JosekiAccessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JosekiAccessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.air_molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      air_molar_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.column_mass_density" class="md-nav__link">
    <span class="md-ellipsis">
      column_mass_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.column_number_density" class="md-nav__link">
    <span class="md-ellipsis">
      column_number_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.is_valid" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mass_density_at_sea_level" class="md-nav__link">
    <span class="md-ellipsis">
      mass_density_at_sea_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mass_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      mass_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mole_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      mole_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mole_fraction_at_sea_level" class="md-nav__link">
    <span class="md-ellipsis">
      mole_fraction_at_sea_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.molecules" class="md-nav__link">
    <span class="md-ellipsis">
      molecules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.number_density_at_sea_level" class="md-nav__link">
    <span class="md-ellipsis">
      number_density_at_sea_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.drop_molecules" class="md-nav__link">
    <span class="md-ellipsis">
      drop_molecules()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.rescale" class="md-nav__link">
    <span class="md-ellipsis">
      rescale()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.rescale_to" class="md-nav__link">
    <span class="md-ellipsis">
      rescale_to()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.scaling_factors" class="md-nav__link">
    <span class="md-ellipsis">
      scaling_factors()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.molecular_mass" class="md-nav__link">
    <span class="md-ellipsis">
      molecular_mass()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.factory" class="md-nav__link">
    <span class="md-ellipsis">
      factory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="factory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory" class="md-nav__link">
    <span class="md-ellipsis">
      ProfileFactory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProfileFactory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory.registered_identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      registered_identifiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory.create" class="md-nav__link">
    <span class="md-ellipsis">
      create()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory.register" class="md-nav__link">
    <span class="md-ellipsis">
      register()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.core" class="md-nav__link">
    <span class="md-ellipsis">
      core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.Profile" class="md-nav__link">
    <span class="md-ellipsis">
      Profile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Profile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.Profile.to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataset()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.extrapolate" class="md-nav__link">
    <span class="md-ellipsis">
      extrapolate()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.interp" class="md-nav__link">
    <span class="md-ellipsis">
      interp()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.regularize" class="md-nav__link">
    <span class="md-ellipsis">
      regularize()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.rescale_to_column" class="md-nav__link">
    <span class="md-ellipsis">
      rescale_to_column()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.select_molecules" class="md-nav__link">
    <span class="md-ellipsis">
      select_molecules()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.schema" class="md-nav__link">
    <span class="md-ellipsis">
      schema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.Schema" class="md-nav__link">
    <span class="md-ellipsis">
      Schema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.Schema.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.Schema.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.mole_fraction_sum" class="md-nav__link">
    <span class="md-ellipsis">
      mole_fraction_sum()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986" class="md-nav__link">
    <span class="md-ellipsis">
      afgl_1986
    </span>
  </a>
  
    <nav class="md-nav" aria-label="afgl_1986">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986MidlatitudeSummer" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986MidlatitudeSummer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986MidlatitudeWinter" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986MidlatitudeWinter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986SubarcticSummer" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986SubarcticSummer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986SubarcticWinter" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986SubarcticWinter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986Tropical" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986Tropical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986USStandard" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986USStandard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.Identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Identifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.dataframe_to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      dataframe_to_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.get_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.parse" class="md-nav__link">
    <span class="md-ellipsis">
      parse()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataset()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007" class="md-nav__link">
    <span class="md-ellipsis">
      mipas_2007
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mipas_2007">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.Identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Identifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASMidlatitudeDay" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASMidlatitudeDay
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASMidlatitudeNight" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASMidlatitudeNight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASPolarSummer" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASPolarSummer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASPolarWinter" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASPolarWinter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASTropical" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASTropical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.get_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_content" class="md-nav__link">
    <span class="md-ellipsis">
      parse_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_units" class="md-nav__link">
    <span class="md-ellipsis">
      parse_units()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_values_line" class="md-nav__link">
    <span class="md-ellipsis">
      parse_values_line()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_var_line" class="md-nav__link">
    <span class="md-ellipsis">
      parse_var_line()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_var_name" class="md-nav__link">
    <span class="md-ellipsis">
      parse_var_name()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.read_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      read_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.to_chemical_formula" class="md-nav__link">
    <span class="md-ellipsis">
      to_chemical_formula()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.translate_cfc" class="md-nav__link">
    <span class="md-ellipsis">
      translate_cfc()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.ussa_1976" class="md-nav__link">
    <span class="md-ellipsis">
      ussa_1976
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ussa_1976">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.ussa_1976.USSA1976" class="md-nav__link">
    <span class="md-ellipsis">
      USSA1976
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.util" class="md-nav__link">
    <span class="md-ellipsis">
      util
    </span>
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.air_molar_mass_from_mass_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      air_molar_mass_from_mass_fraction()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.number_density" class="md-nav__link">
    <span class="md-ellipsis">
      number_density()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.utcnow" class="md-nav__link">
    <span class="md-ellipsis">
      utcnow()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.core" class="md-nav__link">
    <span class="md-ellipsis">
      core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.core.identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      identifiers()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.load_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      load_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.make" class="md-nav__link">
    <span class="md-ellipsis">
      make()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.merge" class="md-nav__link">
    <span class="md-ellipsis">
      merge()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.open_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      open_dataset()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.units" class="md-nav__link">
    <span class="md-ellipsis">
      units
    </span>
  </a>
  
    <nav class="md-nav" aria-label="units">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.units.to_quantity" class="md-nav__link">
    <span class="md-ellipsis">
      to_quantity()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.util" class="md-nav__link">
    <span class="md-ellipsis">
      util
    </span>
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.air_molar_mass_from_mass_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      air_molar_mass_from_mass_fraction()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.number_density" class="md-nav__link">
    <span class="md-ellipsis">
      number_density()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.utcnow" class="md-nav__link">
    <span class="md-ellipsis">
      utcnow()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliography
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#joseki.accessor" class="md-nav__link">
    <span class="md-ellipsis">
      accessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="accessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor" class="md-nav__link">
    <span class="md-ellipsis">
      JosekiAccessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="JosekiAccessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.air_molar_mass" class="md-nav__link">
    <span class="md-ellipsis">
      air_molar_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.column_mass_density" class="md-nav__link">
    <span class="md-ellipsis">
      column_mass_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.column_number_density" class="md-nav__link">
    <span class="md-ellipsis">
      column_number_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.is_valid" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mass_density_at_sea_level" class="md-nav__link">
    <span class="md-ellipsis">
      mass_density_at_sea_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mass_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      mass_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mole_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      mole_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.mole_fraction_at_sea_level" class="md-nav__link">
    <span class="md-ellipsis">
      mole_fraction_at_sea_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.molecules" class="md-nav__link">
    <span class="md-ellipsis">
      molecules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.number_density_at_sea_level" class="md-nav__link">
    <span class="md-ellipsis">
      number_density_at_sea_level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.drop_molecules" class="md-nav__link">
    <span class="md-ellipsis">
      drop_molecules()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.rescale" class="md-nav__link">
    <span class="md-ellipsis">
      rescale()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.rescale_to" class="md-nav__link">
    <span class="md-ellipsis">
      rescale_to()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.scaling_factors" class="md-nav__link">
    <span class="md-ellipsis">
      scaling_factors()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.JosekiAccessor.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.accessor.molecular_mass" class="md-nav__link">
    <span class="md-ellipsis">
      molecular_mass()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.factory" class="md-nav__link">
    <span class="md-ellipsis">
      factory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="factory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory" class="md-nav__link">
    <span class="md-ellipsis">
      ProfileFactory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProfileFactory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory.registered_identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      registered_identifiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory.create" class="md-nav__link">
    <span class="md-ellipsis">
      create()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.factory.ProfileFactory.register" class="md-nav__link">
    <span class="md-ellipsis">
      register()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.core" class="md-nav__link">
    <span class="md-ellipsis">
      core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.Profile" class="md-nav__link">
    <span class="md-ellipsis">
      Profile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Profile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.Profile.to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataset()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.extrapolate" class="md-nav__link">
    <span class="md-ellipsis">
      extrapolate()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.interp" class="md-nav__link">
    <span class="md-ellipsis">
      interp()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.regularize" class="md-nav__link">
    <span class="md-ellipsis">
      regularize()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.rescale_to_column" class="md-nav__link">
    <span class="md-ellipsis">
      rescale_to_column()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.core.select_molecules" class="md-nav__link">
    <span class="md-ellipsis">
      select_molecules()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.schema" class="md-nav__link">
    <span class="md-ellipsis">
      schema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.Schema" class="md-nav__link">
    <span class="md-ellipsis">
      Schema
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.Schema.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.Schema.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.schema.mole_fraction_sum" class="md-nav__link">
    <span class="md-ellipsis">
      mole_fraction_sum()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986" class="md-nav__link">
    <span class="md-ellipsis">
      afgl_1986
    </span>
  </a>
  
    <nav class="md-nav" aria-label="afgl_1986">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986MidlatitudeSummer" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986MidlatitudeSummer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986MidlatitudeWinter" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986MidlatitudeWinter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986SubarcticSummer" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986SubarcticSummer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986SubarcticWinter" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986SubarcticWinter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986Tropical" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986Tropical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.AFGL1986USStandard" class="md-nav__link">
    <span class="md-ellipsis">
      AFGL1986USStandard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.Identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Identifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.dataframe_to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      dataframe_to_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.get_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.parse" class="md-nav__link">
    <span class="md-ellipsis">
      parse()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.afgl_1986.to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataset()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007" class="md-nav__link">
    <span class="md-ellipsis">
      mipas_2007
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mipas_2007">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.Identifier" class="md-nav__link">
    <span class="md-ellipsis">
      Identifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASMidlatitudeDay" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASMidlatitudeDay
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASMidlatitudeNight" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASMidlatitudeNight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASPolarSummer" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASPolarSummer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASPolarWinter" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASPolarWinter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.MIPASTropical" class="md-nav__link">
    <span class="md-ellipsis">
      MIPASTropical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.get_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_content" class="md-nav__link">
    <span class="md-ellipsis">
      parse_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_units" class="md-nav__link">
    <span class="md-ellipsis">
      parse_units()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_values_line" class="md-nav__link">
    <span class="md-ellipsis">
      parse_values_line()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_var_line" class="md-nav__link">
    <span class="md-ellipsis">
      parse_var_line()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.parse_var_name" class="md-nav__link">
    <span class="md-ellipsis">
      parse_var_name()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.read_file_content" class="md-nav__link">
    <span class="md-ellipsis">
      read_file_content()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.to_chemical_formula" class="md-nav__link">
    <span class="md-ellipsis">
      to_chemical_formula()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.to_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.mipas_2007.translate_cfc" class="md-nav__link">
    <span class="md-ellipsis">
      translate_cfc()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.ussa_1976" class="md-nav__link">
    <span class="md-ellipsis">
      ussa_1976
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ussa_1976">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.ussa_1976.USSA1976" class="md-nav__link">
    <span class="md-ellipsis">
      USSA1976
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.util" class="md-nav__link">
    <span class="md-ellipsis">
      util
    </span>
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.air_molar_mass_from_mass_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      air_molar_mass_from_mass_fraction()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.number_density" class="md-nav__link">
    <span class="md-ellipsis">
      number_density()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.utcnow" class="md-nav__link">
    <span class="md-ellipsis">
      utcnow()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.core" class="md-nav__link">
    <span class="md-ellipsis">
      core
    </span>
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.core.identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      identifiers()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.load_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      load_dataset()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.make" class="md-nav__link">
    <span class="md-ellipsis">
      make()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.merge" class="md-nav__link">
    <span class="md-ellipsis">
      merge()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.core.open_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      open_dataset()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.units" class="md-nav__link">
    <span class="md-ellipsis">
      units
    </span>
  </a>
  
    <nav class="md-nav" aria-label="units">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.units.to_quantity" class="md-nav__link">
    <span class="md-ellipsis">
      to_quantity()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joseki.profiles.util" class="md-nav__link">
    <span class="md-ellipsis">
      util
    </span>
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.air_molar_mass_from_mass_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      air_molar_mass_from_mass_fraction()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.number_density" class="md-nav__link">
    <span class="md-ellipsis">
      number_density()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#joseki.profiles.util.utcnow" class="md-nav__link">
    <span class="md-ellipsis">
      utcnow()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Reference</h1>

<p>This reference manual details functions, modules, and objects included in
<code>joseki</code>, describing what they are and what they do.</p>


<div class="doc doc-object doc-module">




<h2 id="joseki.accessor" class="doc doc-heading">
          <code>joseki.accessor</code>


<a href="#joseki.accessor" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Accessor module.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.accessor.JosekiAccessor" class="doc doc-heading">
          <code>joseki.accessor.JosekiAccessor</code>


<a href="#joseki.accessor.JosekiAccessor" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>Joseki accessor.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/accessor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataset_accessor</span><span class="p">(</span><span class="s2">&quot;joseki&quot;</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="k">class</span> <span class="nc">JosekiAccessor</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Joseki accessor.&quot;&quot;&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">def</span> <span class="nf">molecules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of molecules.&quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">def</span> <span class="nf">column_number_density</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Compute column number density.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            A mapping of molecule and column number density.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            The column number density is given by:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            $$</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            N_{\mathrm{M}} = \int n_{\mathrm{M}}(z) \, \mathrm{d} z</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            $$</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            with</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            $$</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            n_{\mathrm{M}}(z) = x_{\mathrm{M}}(z) \, n(z)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            $$</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            where</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            * $z$ is the altitude,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            * $x_{\mathrm{M}}(z)$ is the mole fraction of molecule M</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            at altitude $z$,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            * $n(z)$ is the air number density at altitude $z$,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            * $n_{\mathrm{M}}(z)$ is the number density of molecule M at</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            altitude $z$.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            The  integration is performed using the trapezoidal rule.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Computing column number density using the trapezoidal rule.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">_column_number_density</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">integral</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ds</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;z&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="p">)</span>  <span class="c1"># integrate using the trapezoidal rule</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]])</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">_column_number_density</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="n">integral</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="p">)</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">return</span> <span class="n">_column_number_density</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">def</span> <span class="nf">column_mass_density</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Compute column mass density.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            A mapping of molecule and column mass density.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            The column mass density is given by:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            $$</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            \sigma_{\mathrm{M}} = N_{\mathrm{M}} \, m_{\mathrm{M}}</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            $$</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            where</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            * $N_{\mathrm{M}}$ is the column number density of molecule M,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            * $m_{\mathrm{M}}$ is the molecular mass of molecule M.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">_column_number_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_number_density</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="n">m</span><span class="p">:</span> <span class="p">(</span><span class="n">molecular_mass</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">_column_number_density</span><span class="p">[</span><span class="n">m</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;kg/m^2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="p">}</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">def</span> <span class="nf">number_density_at_sea_level</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute number density at sea level.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            A mapping of molecule and number density at sea level.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="p">(</span><span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span><span class="p">}</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="k">def</span> <span class="nf">mass_density_at_sea_level</span><span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute mass density at sea level.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            A mapping of molecule and mass density at sea level.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">_number_density_at_sea_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_density_at_sea_level</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="n">m</span><span class="p">:</span> <span class="p">(</span><span class="n">molecular_mass</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">_number_density_at_sea_level</span><span class="p">[</span><span class="n">m</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;kg/m^3&quot;</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="p">}</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">def</span> <span class="nf">mole_fraction_at_sea_level</span><span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute mole fraction at sea level.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            A mapping of molecule and mole fraction at sea level.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span><span class="p">}</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">def</span> <span class="nf">mole_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract mole fraction and tabulate as a function of (m, z).</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            Mole fraction.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">molecules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">concatenated</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">concatenated</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">molecules</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;molecule&quot;</span><span class="p">})</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">concatenated</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="p">{</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;mole_fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;mole fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;dimensionless&quot;</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="p">}</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">concatenated</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">return</span> <span class="n">concatenated</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">def</span> <span class="nf">mass_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract mass fraction and tabulate as a function of (m, z).</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            Mass fraction.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mole_fraction</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">m_air</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">air_molar_mass</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">molar_mass</span><span class="p">(</span><span class="n">molecules</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">molecules</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">m</span> <span class="o">/</span> <span class="n">m_air</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="n">y</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="p">{</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;mass_fraction_in_air&quot;</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;mass fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;kg * kg^-1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="p">}</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="k">return</span> <span class="n">y</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">def</span> <span class="nf">air_molar_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        Compute air molar mass as a function of altitude.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            Air molar mass.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            The air molar mass is given by:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            $$</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            M_{\mathrm{air}} =</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            \frac{</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">                \sum_{\mathrm{M}} x_{\mathrm{M}} \, m_{\mathrm{M}}</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            }{</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                \sum_{\mathrm{M}} x_{\mathrm{M}}</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            }</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            $$</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            where</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            * $x_{\mathrm{M}}$ is the mole fraction of molecule M,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            * $m_{\mathrm{M}}$ is the molar mass of molecule M.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            To compute the air molar mass accurately, the mole fraction of</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            molecular nitrogen (N2), molecular oxygen (O2), and argon (Ar) are</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            required. If these are not present in the dataset, they are</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            computed using the assumption that the mole fraction of these</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            molecules are constant with altitude and set to the following</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            values:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            * molecular nitrogen (N2): 0.78084</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            * molecular oxygen (O2): 0.209476</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            * argon (Ar): 0.00934</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            are independent of altitude.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            Since nothing garantees that the mole fraction sum is equal to</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            one, the air molar mass is computed as the sum of the mole</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            fraction weighted molar mass divided by the sum of the mole</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            fraction.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="c1"># for molar mass computation to be accurate, main air constituents</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="c1"># must be present in the dataset</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">ds_copy</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">AIR_MAIN_CONSTITUENTS_MOLAR_FRACTION</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">AIR_MAIN_CONSTITUENTS_MOLAR_FRACTION</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="n">ds_copy</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="n">ds_copy</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;dimensionless&quot;</span><span class="p">})</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="c1"># compute air molar mass</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">ds_copy</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">mole_fraction</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">molecules</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">mm</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">MM</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]),</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">molecules</span><span class="p">)},</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;dimensionless&quot;</span><span class="p">},</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">mm_average</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">mm</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">))</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">mm_average</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="p">{</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>                <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;air molar mass&quot;</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;kg/mol&quot;</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="p">}</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">return</span> <span class="n">mm_average</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">def</span> <span class="nf">scaling_factors</span><span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">]</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute scaling factor(s) to reach specific target amount(s).</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            target: Mapping of molecule and target amount.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            ValueError: If a target amount has dimensions that are not supported.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            Mapping of molecule and scaling factors.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            For each molecule in the ``target`` mapping, the target amount is</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            interpreted, depending on its dimensions (indicated in square</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            brackets), as:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            * a column number density [`length^-2`],</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            * a column mass density [`mass * length^-2`],</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            * a number density at sea level [`length^-3`],</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            * a mass density at sea level [`mass * length^-3`],</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            * a mole fraction at sea level [`dimensionless`]</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            The scaling factor is then evaluated as the ratio of the target</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            amount with the original amount, for each molecule.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        See Also:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            `rescale`</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">compute_initial_amount</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="s2">&quot;[length]^-2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_number_density</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="s2">&quot;[mass] * [length]^-2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_mass_density</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="s2">&quot;[length]^-3&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_density_at_sea_level</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="s2">&quot;[mass] * [length]^-3&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_density_at_sea_level</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mole_fraction_at_sea_level</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="p">}</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">factors</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">target_amount</span> <span class="ow">in</span> <span class="n">target</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">target_amount</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">target_amount</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="n">initial_amount</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">compute_initial_amount</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                <span class="k">if</span> <span class="n">target_amount</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                    <span class="n">initial_amount</span> <span class="o">=</span> <span class="n">compute_initial_amount</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">m</span><span class="p">]</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="k">if</span> <span class="n">initial_amount</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="k">raise</span> <span class="ne">ValueError</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">_scaling_factor</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="n">initial_amount</span><span class="o">=</span><span class="n">initial_amount</span><span class="p">,</span> <span class="n">target_amount</span><span class="o">=</span><span class="n">target_amount</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="k">return</span> <span class="n">factors</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="k">def</span> <span class="nf">rescale</span><span class="p">(</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Rescale molecules concentration in atmospheric profile.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            factors: A mapping of molecule and scaling factor.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            check_x_sum: if True, check that mole fraction sums</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">                are never larger than one.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            ValueError: if `check_x_sum` is `True` and the</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">                dataset is not valid.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">            Rescaled dataset (new object).</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="c1"># update mole fraction</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">x_new</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                <span class="n">x_new</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">x_new</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="c1"># validate rescaled dataset</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot rescale&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="c1"># update history attribute</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">factors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2"> - rescaled </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&#39;s mole fraction using a scaling &quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="sa">f</span><span class="s2">&quot;factor of </span><span class="si">{</span><span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> - joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">return</span> <span class="n">ds</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="k">def</span> <span class="nf">rescale_to</span><span class="p">(</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">target</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">],</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        Rescale mole fractions to match target molecular total column</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        densities.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            target: Mapping of molecule and target total column density.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">                Total column must be either a column number density</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">                [`length^-2`], a column mass density [`mass * length^-2`], a</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">                number density at sea level [`length^-3`], a mass density at</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">                sea level [`mass * length^-3`], a mole fraction at</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">                sea level [`dimensionless`].</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            check_x_sum: if True, check that mole fraction sums are never</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">                larger than one.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            Rescaled dataset (new object).</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="n">factors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling_factors</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">),</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="k">def</span> <span class="nf">drop_molecules</span><span class="p">(</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">molecules</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Drop molecules from dataset.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">            molecules: List of molecules to drop.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            Dataset with molecules dropped.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="c1"># update history attribute</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2"> - dropped mole fraction data for molecules &quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span><span class="si">}</span><span class="s2"> - joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">])</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">ret_true_if_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate atmosphere thermophysical profile dataset schema.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            `True` if the dataset complies with the schema, else `False`.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="k">return</span> <span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="n">ret_true_if_valid</span><span class="o">=</span><span class="n">ret_true_if_valid</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        Return `True` if the dataset complies with the schema, else `False`.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ret_true_if_valid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.air_molar_mass" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">air_molar_mass</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.air_molar_mass" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute air molar mass as a function of altitude.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air molar mass.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The air molar mass is given by:</p>
<div class="arithmatex">\[
M_{\mathrm{air}} =
\frac{
    \sum_{\mathrm{M}} x_{\mathrm{M}} \, m_{\mathrm{M}}
}{
    \sum_{\mathrm{M}} x_{\mathrm{M}}
}
\]</div>
<p>where
* <span class="arithmatex">\(x_{\mathrm{M}}\)</span> is the mole fraction of molecule M,
* <span class="arithmatex">\(m_{\mathrm{M}}\)</span> is the molar mass of molecule M.</p>
<p>To compute the air molar mass accurately, the mole fraction of
molecular nitrogen (N2), molecular oxygen (O2), and argon (Ar) are
required. If these are not present in the dataset, they are
computed using the assumption that the mole fraction of these
molecules are constant with altitude and set to the following
values:</p>
<ul>
<li>molecular nitrogen (N2): 0.78084</li>
<li>molecular oxygen (O2): 0.209476</li>
<li>argon (Ar): 0.00934</li>
</ul>
<p>are independent of altitude.</p>
<p>Since nothing garantees that the mole fraction sum is equal to
one, the air molar mass is computed as the sum of the mole
fraction weighted molar mass divided by the sum of the mole
fraction.</p>
</details>  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.column_mass_density" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">column_mass_density</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.column_mass_density" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute column mass density.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of molecule and column mass density.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The column mass density is given by:</p>
<div class="arithmatex">\[
\sigma_{\mathrm{M}} = N_{\mathrm{M}} \, m_{\mathrm{M}}
\]</div>
<p>where</p>
<ul>
<li><span class="arithmatex">\(N_{\mathrm{M}}\)</span> is the column number density of molecule M,</li>
<li><span class="arithmatex">\(m_{\mathrm{M}}\)</span> is the molecular mass of molecule M.</li>
</ul>
</details>  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.column_number_density" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">column_number_density</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.column_number_density" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute column number density.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of molecule and column number density.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The column number density is given by:</p>
<div class="arithmatex">\[
N_{\mathrm{M}} = \int n_{\mathrm{M}}(z) \, \mathrm{d} z
\]</div>
<p>with</p>
<div class="arithmatex">\[
n_{\mathrm{M}}(z) = x_{\mathrm{M}}(z) \, n(z)
\]</div>
<p>where</p>
<ul>
<li><span class="arithmatex">\(z\)</span> is the altitude,</li>
<li><span class="arithmatex">\(x_{\mathrm{M}}(z)\)</span> is the mole fraction of molecule M
at altitude <span class="arithmatex">\(z\)</span>,</li>
<li><span class="arithmatex">\(n(z)\)</span> is the air number density at altitude <span class="arithmatex">\(z\)</span>,</li>
<li><span class="arithmatex">\(n_{\mathrm{M}}(z)\)</span> is the number density of molecule M at
altitude <span class="arithmatex">\(z\)</span>.</li>
</ul>
<p>The  integration is performed using the trapezoidal rule.</p>
</details>  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.is_valid" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">is_valid</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.is_valid" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return <code>True</code> if the dataset complies with the schema, else <code>False</code>.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.mass_density_at_sea_level" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">mass_density_at_sea_level</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.mass_density_at_sea_level" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute mass density at sea level.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of molecule and mass density at sea level.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.mass_fraction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">mass_fraction</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.mass_fraction" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Extract mass fraction and tabulate as a function of (m, z).</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mass fraction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.mole_fraction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">mole_fraction</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.mole_fraction" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Extract mole fraction and tabulate as a function of (m, z).</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mole fraction.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.mole_fraction_at_sea_level" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">mole_fraction_at_sea_level</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.mole_fraction_at_sea_level" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute mole fraction at sea level.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of molecule and mole fraction at sea level.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.molecules" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.molecules" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return list of molecules.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h4 id="joseki.accessor.JosekiAccessor.number_density_at_sea_level" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">number_density_at_sea_level</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.accessor.JosekiAccessor.number_density_at_sea_level" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute number density at sea level.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of molecule and number density at sea level.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>




<div class="doc doc-object doc-function">




<h4 id="joseki.accessor.JosekiAccessor.drop_molecules" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">drop_molecules</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span></code>

<a href="#joseki.accessor.JosekiAccessor.drop_molecules" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Drop molecules from dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>molecules</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of molecules to drop.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset with molecules dropped.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/accessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="k">def</span> <span class="nf">drop_molecules</span><span class="p">(</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">molecules</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Drop molecules from dataset.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        molecules: List of molecules to drop.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        Dataset with molecules dropped.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="c1"># update history attribute</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2"> - dropped mole fraction data for molecules &quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">molecules</span><span class="p">)</span><span class="si">}</span><span class="s2"> - joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="joseki.accessor.JosekiAccessor.rescale" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="n">check_x_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#joseki.accessor.JosekiAccessor.rescale" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Rescale molecules concentration in atmospheric profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>factors</code></td>
          <td>
                <code><span title="typing.MutableMapping">MutableMapping</span>[str, float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping of molecule and scaling factor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>check_x_sum</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if True, check that mole fraction sums
are never larger than one.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:
    ValueError: if <code>check_x_sum</code> is <code>True</code> and the
        dataset is not valid.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Rescaled dataset (new object).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/accessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="k">def</span> <span class="nf">rescale</span><span class="p">(</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">factors</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rescale molecules concentration in atmospheric profile.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        factors: A mapping of molecule and scaling factor.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        check_x_sum: if True, check that mole fraction sums</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            are never larger than one.</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        ValueError: if `check_x_sum` is `True` and the</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            dataset is not valid.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        Rescaled dataset (new object).</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="c1"># update mole fraction</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">x_new</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">factors</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="n">x_new</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">x_new</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># validate rescaled dataset</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot rescale&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="c1"># update history attribute</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">factors</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2"> - rescaled </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&#39;s mole fraction using a scaling &quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="sa">f</span><span class="s2">&quot;factor of </span><span class="si">{</span><span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> - joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="k">return</span> <span class="n">ds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="joseki.accessor.JosekiAccessor.rescale_to" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">rescale_to</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">check_x_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#joseki.accessor.JosekiAccessor.rescale_to" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Rescale mole fractions to match target molecular total column
densities.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, <span title="pint.Quantity">Quantity</span> | dict | <span title="xarray.DataArray">DataArray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of molecule and target total column density.
Total column must be either a column number density
[<code>length^-2</code>], a column mass density [<code>mass * length^-2</code>], a
number density at sea level [<code>length^-3</code>], a mass density at
sea level [<code>mass * length^-3</code>], a mole fraction at
sea level [<code>dimensionless</code>].</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>check_x_sum</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if True, check that mole fraction sums are never
larger than one.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Rescaled dataset (new object).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/accessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="k">def</span> <span class="nf">rescale_to</span><span class="p">(</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="n">target</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">],</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    Rescale mole fractions to match target molecular total column</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">    densities.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        target: Mapping of molecule and target total column density.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">            Total column must be either a column number density</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">            [`length^-2`], a column mass density [`mass * length^-2`], a</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">            number density at sea level [`length^-3`], a mass density at</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            sea level [`mass * length^-3`], a mole fraction at</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            sea level [`dimensionless`].</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        check_x_sum: if True, check that mole fraction sums are never</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            larger than one.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        Rescaled dataset (new object).</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">factors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaling_factors</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">),</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="joseki.accessor.JosekiAccessor.scaling_factors" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">scaling_factors</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code>

<a href="#joseki.accessor.JosekiAccessor.scaling_factors" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Compute scaling factor(s) to reach specific target amount(s).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>target</code></td>
          <td>
                <code><span title="typing.MutableMapping">MutableMapping</span>[str, <span title="pint.Quantity">Quantity</span> | dict | <span title="xarray.DataArray">DataArray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of molecule and target amount.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If a target amount has dimensions that are not supported.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.MutableMapping">MutableMapping</span>[str, float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of molecule and scaling factors.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>For each molecule in the <code>target</code> mapping, the target amount is
interpreted, depending on its dimensions (indicated in square
brackets), as:</p>
<ul>
<li>a column number density [<code>length^-2</code>],</li>
<li>a column mass density [<code>mass * length^-2</code>],</li>
<li>a number density at sea level [<code>length^-3</code>],</li>
<li>a mass density at sea level [<code>mass * length^-3</code>],</li>
<li>a mole fraction at sea level [<code>dimensionless</code>]</li>
</ul>
<p>The scaling factor is then evaluated as the ratio of the target
amount with the original amount, for each molecule.</p>
</details>
<details class="see-also" open>
  <summary>See Also</summary>
  <p><code>rescale</code></p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/accessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="k">def</span> <span class="nf">scaling_factors</span><span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">]</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">MutableMapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute scaling factor(s) to reach specific target amount(s).</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        target: Mapping of molecule and target amount.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        ValueError: If a target amount has dimensions that are not supported.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        Mapping of molecule and scaling factors.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        For each molecule in the ``target`` mapping, the target amount is</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        interpreted, depending on its dimensions (indicated in square</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        brackets), as:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        * a column number density [`length^-2`],</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        * a column mass density [`mass * length^-2`],</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        * a number density at sea level [`length^-3`],</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        * a mass density at sea level [`mass * length^-3`],</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        * a mole fraction at sea level [`dimensionless`]</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        The scaling factor is then evaluated as the ratio of the target</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        amount with the original amount, for each molecule.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        `rescale`</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">compute_initial_amount</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="s2">&quot;[length]^-2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_number_density</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="s2">&quot;[mass] * [length]^-2&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_mass_density</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="s2">&quot;[length]^-3&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_density_at_sea_level</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="s2">&quot;[mass] * [length]^-3&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_density_at_sea_level</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">mole_fraction_at_sea_level</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="p">}</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">factors</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">target_amount</span> <span class="ow">in</span> <span class="n">target</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="n">target_amount</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">target_amount</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">initial_amount</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">compute_initial_amount</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="k">if</span> <span class="n">target_amount</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="n">initial_amount</span> <span class="o">=</span> <span class="n">compute_initial_amount</span><span class="p">[</span><span class="n">dim</span><span class="p">][</span><span class="n">m</span><span class="p">]</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="k">if</span> <span class="n">initial_amount</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="k">raise</span> <span class="ne">ValueError</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">_scaling_factor</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="n">initial_amount</span><span class="o">=</span><span class="n">initial_amount</span><span class="p">,</span> <span class="n">target_amount</span><span class="o">=</span><span class="n">target_amount</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">return</span> <span class="n">factors</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="joseki.accessor.JosekiAccessor.validate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">JosekiAccessor</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">check_x_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ret_true_if_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#joseki.accessor.JosekiAccessor.validate" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Validate atmosphere thermophysical profile dataset schema.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>True</code> if the dataset complies with the schema, else <code>False</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/accessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="n">ret_true_if_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate atmosphere thermophysical profile dataset schema.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        `True` if the dataset complies with the schema, else `False`.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">return</span> <span class="n">schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">ret_true_if_valid</span><span class="o">=</span><span class="n">ret_true_if_valid</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="joseki.accessor.molecular_mass" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">accessor</span><span class="o">.</span><span class="n">molecular_mass</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code>

<a href="#joseki.accessor.molecular_mass" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return the average molecular mass of a molecule.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>m</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Molecule formula.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Average molecular mass.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/accessor.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span> <span class="nf">molecular_mass</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the average molecular mass of a molecule.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        m: Molecule formula.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        Average molecular mass.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="k">return</span> <span class="n">MM</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">ureg</span><span class="p">(</span><span class="s2">&quot;dalton&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.data" class="doc doc-heading">
          <code>joseki.data</code>


<a href="#joseki.data" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Raw data files.</p>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.factory" class="doc doc-heading">
          <code>joseki.profiles.factory</code>


<a href="#joseki.profiles.factory" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Profile factory module.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.factory.ProfileFactory" class="doc doc-heading">
          <code>joseki.profiles.factory.ProfileFactory</code>


<a href="#joseki.profiles.factory.ProfileFactory" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>Profile factory class.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/factory.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="nd">@define</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="k">class</span> <span class="nc">ProfileFactory</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Profile factory class.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Profile registry.&quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">registry</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Profile</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">def</span> <span class="nf">registered_identifiers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        Registered profile identifiers.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            List of registered profile identifiers.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        Register a profile class.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            identifier: Profile identifier.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            Decorator function.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="k">def</span> <span class="nf">inner_wrapper</span><span class="p">(</span><span class="n">wrapped_class</span><span class="p">:</span> <span class="n">Profile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Registering profile </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>                    <span class="s2">&quot;Profile </span><span class="si">%s</span><span class="s2"> already exists. Will replace it&quot;</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>                    <span class="n">identifier</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>                <span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrapped_class</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="k">return</span> <span class="n">wrapped_class</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">return</span> <span class="n">inner_wrapper</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Profile</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        Create a profile instance.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            identifier: Profile identifier.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            Profile instance.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;Profile </span><span class="si">%s</span><span class="s2"> does not exist in the registry&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Profile </span><span class="si">{</span><span class="n">identifier</span><span class="si">}</span><span class="s2"> does not exist in the registry&quot;</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating profile </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">profile_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">profile</span> <span class="o">=</span> <span class="n">profile_cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">return</span> <span class="n">profile</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h4 id="joseki.profiles.factory.ProfileFactory.registered_identifiers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">ProfileFactory</span><span class="o">.</span><span class="n">registered_identifiers</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#joseki.profiles.factory.ProfileFactory.registered_identifiers" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Registered profile identifiers.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of registered profile identifiers.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>




<div class="doc doc-object doc-function">




<h4 id="joseki.profiles.factory.ProfileFactory.create" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">ProfileFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.profiles.factory.ProfileFactory.create" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Create a profile instance.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile identifier.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/factory.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Profile</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    Create a profile instance.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        identifier: Profile identifier.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        Profile instance.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">if</span> <span class="n">identifier</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s2">&quot;Profile </span><span class="si">%s</span><span class="s2"> does not exist in the registry&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Profile </span><span class="si">{</span><span class="n">identifier</span><span class="si">}</span><span class="s2"> does not exist in the registry&quot;</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating profile </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">profile_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">profile</span> <span class="o">=</span> <span class="n">profile_cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">return</span> <span class="n">profile</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="joseki.profiles.factory.ProfileFactory.register" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">ProfileFactory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span></code>

<a href="#joseki.profiles.factory.ProfileFactory.register" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Register a profile class.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile identifier.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Decorator function.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/factory.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="k">def</span> <span class="nf">register</span><span class="p">(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Register a profile class.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        identifier: Profile identifier.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        Decorator function.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span> <span class="nf">inner_wrapper</span><span class="p">(</span><span class="n">wrapped_class</span><span class="p">:</span> <span class="n">Profile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Registering profile </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>                <span class="s2">&quot;Profile </span><span class="si">%s</span><span class="s2"> already exists. Will replace it&quot;</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>                <span class="n">identifier</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">wrapped_class</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">return</span> <span class="n">wrapped_class</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">return</span> <span class="n">inner_wrapper</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.core" class="doc doc-heading">
          <code>joseki.profiles.core</code>


<a href="#joseki.profiles.core" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Core module for atmosphere thermophysical profiles.</p>
<p>The <code>Profile</code> abstract class defines the interface for atmosphere thermophysical
profiles.
The <code>interp</code> function is used to interpolate an atmosphere thermophysical
profile on new altitude values.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.core.Profile" class="doc doc-heading">
          <code>joseki.profiles.core.Profile</code>


<a href="#joseki.profiles.core.Profile" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Abstract class for atmosphere thermophysical profiles.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="nd">@define</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="k">class</span> <span class="nc">Profile</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Abstract class for atmosphere thermophysical profiles.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        Return the profile as a dataset.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            z: Altitude grid.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">                If the profile can be evaluated at arbitrary altitudes, this</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">                parameter is passed to the evaluating method for that profile.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">                If the profile is defined on a fixed altitude grid, this parameter</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">                is used to interpolate the profile on the specified altitude grid.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            interp_method: Interpolation method for each variable.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">                If ``None``, the default interpolation method is used.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">                Interpolation may be required if the profile is defined on a fixed</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">                altitude grid, and the altitude grid is not the same as the one</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">                used to define the profile.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">                Interpolation may also not be required, e.g. if the profile is</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">                defined by analytical function(s) of the altitude variable.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            conserve_column: If `True`, ensure that column densities are conserved</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">                during interpolation.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            kwargs: Parameters passed to lower-level methods.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">            Atmospheric profile.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h4 id="joseki.profiles.core.Profile.to_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Profile</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interp_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#joseki.profiles.core.Profile.to_dataset" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Return the profile as a dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>z</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Altitude grid.
If the profile can be evaluated at arbitrary altitudes, this
parameter is passed to the evaluating method for that profile.
If the profile is defined on a fixed altitude grid, this parameter
is used to interpolate the profile on the specified altitude grid.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>interp_method</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[str, str]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Interpolation method for each variable.
If <code>None</code>, the default interpolation method is used.
Interpolation may be required if the profile is defined on a fixed
altitude grid, and the altitude grid is not the same as the one
used to define the profile.
Interpolation may also not be required, e.g. if the profile is
defined by analytical function(s) of the altitude variable.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_column</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, ensure that column densities are conserved
during interpolation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameters passed to lower-level methods.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    Return the profile as a dataset.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        z: Altitude grid.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            If the profile can be evaluated at arbitrary altitudes, this</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            parameter is passed to the evaluating method for that profile.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            If the profile is defined on a fixed altitude grid, this parameter</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">            is used to interpolate the profile on the specified altitude grid.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        interp_method: Interpolation method for each variable.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            If ``None``, the default interpolation method is used.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            Interpolation may be required if the profile is defined on a fixed</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            altitude grid, and the altitude grid is not the same as the one</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            used to define the profile.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            Interpolation may also not be required, e.g. if the profile is</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            defined by analytical function(s) of the altitude variable.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        conserve_column: If `True`, ensure that column densities are conserved</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            during interpolation.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        kwargs: Parameters passed to lower-level methods.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Atmospheric profile.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.core.extrapolate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">extrapolate</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">z_extra</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">DEFAULT_METHOD</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#joseki.profiles.core.extrapolate" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extrapolate an atmospheric profile to new altitude(s).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial atmospheric profile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>z_extra</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Altitude(s) to extrapolate to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>direction</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Direction of the extrapolation, either "up" or "down".</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of variable and interpolation method.
If a variable is not in the mapping, the linear interpolation is used.
By default, linear interpolation is used for all variables.</p>
            </div>
          </td>
          <td>
                <code><span title="joseki.profiles.core.DEFAULT_METHOD">DEFAULT_METHOD</span></code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_column</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, ensure that column densities are conserved.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the extrapolation direction is not "up" or "down".</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Extrapolated atmospheric profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="k">def</span> <span class="nf">extrapolate</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">z_extra</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">direction</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_METHOD</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Extrapolate an atmospheric profile to new altitude(s).</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        ds: Initial atmospheric profile.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        z_extra: Altitude(s) to extrapolate to.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        direction: Direction of the extrapolation, either &quot;up&quot; or &quot;down&quot;.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        method: Mapping of variable and interpolation method.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            If a variable is not in the mapping, the linear interpolation is used.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            By default, linear interpolation is used for all variables.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        conserve_column: If True, ensure that column densities are conserved.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        ValueError: If the extrapolation direction is not &quot;up&quot; or &quot;down&quot;.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Extrapolated atmospheric profile.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="n">direction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="sa">f</span><span class="s2">&quot;Extrapolation direction must be either &#39;up&#39; or &#39;down&#39;, got &quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">direction</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z_extra</span> <span class="o">&gt;=</span> <span class="n">z</span><span class="o">.</span><span class="n">min</span><span class="p">()):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="sa">f</span><span class="s2">&quot;Cannot extrapolate down to </span><span class="si">{</span><span class="n">z_extra</span><span class="si">:</span><span class="s2">~P</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="sa">f</span><span class="s2">&quot;minimum altitude is </span><span class="si">{</span><span class="n">z</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">~P</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z_extra</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()):</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="sa">f</span><span class="s2">&quot;Cannot extrapolate up to </span><span class="si">{</span><span class="n">z_extra</span><span class="si">:</span><span class="s2">~P</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="sa">f</span><span class="s2">&quot;maximum altitude is </span><span class="si">{</span><span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">~P</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">extrapolated</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">z_new</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">z_extra</span><span class="p">),</span> <span class="n">z</span><span class="p">]),</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">extrapolated</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">history</span><span class="o">=</span><span class="n">extrapolated</span><span class="o">.</span><span class="n">history</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">utcnow</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="sa">f</span><span class="s2">&quot;- extrapolate - joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="k">return</span> <span class="n">extrapolated</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.core.interp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">z_new</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">DEFAULT_METHOD</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.profiles.core.interp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Interpolate atmospheric profile on new altitudes.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile to interpolate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>z_new</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Altitudes values at which to interpolate the atmospheric profile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of variable and interpolation method.
If a variable is not in the mapping, the linear interpolation is used.
By default, linear interpolation is used for all variables.</p>
            </div>
          </td>
          <td>
                <code><span title="joseki.profiles.core.DEFAULT_METHOD">DEFAULT_METHOD</span></code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_column</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, ensure that column densities are conserved.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Parameters passed to <code>scipy.interpolate.interp1d</code> (except
'kind' and 'bounds_error').</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Interpolated atmospheric profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="k">def</span> <span class="nf">interp</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">z_new</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_METHOD</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Interpolate atmospheric profile on new altitudes.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        ds: Atmospheric profile to interpolate.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        z_new: Altitudes values at which to interpolate the atmospheric profile.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        method: Mapping of variable and interpolation method.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            If a variable is not in the mapping, the linear interpolation is used.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            By default, linear interpolation is used for all variables.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        conserve_column: If True, ensure that column densities are conserved.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        kwargs: Parameters passed to `scipy.interpolate.interp1d` (except</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            &#39;kind&#39; and &#39;bounds_error&#39;).</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        Interpolated atmospheric profile.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="c1"># sort altitude values</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">z_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">z_new</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">z_units</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">z_new_values</span> <span class="o">=</span> <span class="n">z_new</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">z_units</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">z_new</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">z_units</span><span class="p">)}</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="c1"># kwargs cannot contain &#39;kind&#39; and &#39;bounds_error&#39;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;kind&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bounds_error&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;fill_value&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;extrapolate&quot;</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">bounds_error</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">bounds_error</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="c1"># Interpolate pressure, temperature and density</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">data_vars</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">x</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">y</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">kind</span><span class="o">=</span><span class="n">method</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">method</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]),</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="n">bounds_error</span><span class="o">=</span><span class="n">bounds_error</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z_new_values</span><span class="p">),</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">])</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># Interpolate mole fraction</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">x</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">y</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">kind</span><span class="o">=</span><span class="n">method</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">method</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]),</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">bounds_error</span><span class="o">=</span><span class="n">bounds_error</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z_new_values</span><span class="p">),</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">])</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="c1"># Attributes</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">attrs</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">author</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="p">{</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="s2">&quot;history&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">utcnow</span><span class="p">()</span><span class="si">}</span><span class="s2"> - dataset interpolation by </span><span class="si">{</span><span class="n">author</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="p">}</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="c1"># Convert to dataset</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;convert interpolated data to dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">interpolated</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">data_vars</span><span class="o">=</span><span class="n">data_vars</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="c1"># Compute scaling factors to conserve column densities</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">if</span> <span class="n">conserve_column</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">return</span> <span class="n">rescale_to_column</span><span class="p">(</span><span class="n">reference</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds</span><span class="o">=</span><span class="n">interpolated</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">return</span> <span class="n">interpolated</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.core.regularize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">regularize</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">DEFAULT_METHOD</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">DEFAULT_OPTIONS</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.profiles.core.regularize" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Regularize the profile's altitude grid.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial atmospheric profile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of variable and interpolation method.
If a variable is not in the mapping, the linear interpolation is used.
By default, linear interpolation is used for all variables.</p>
            </div>
          </td>
          <td>
                <code><span title="joseki.profiles.core.DEFAULT_METHOD">DEFAULT_METHOD</span></code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_column</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, ensure that column densities are conserved.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>options</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[int, str, <span title="pint.Quantity">Quantity</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Options for the regularization.
Mapping with possible keys:
    - "num": Number of points in the new altitude grid.
    - "zstep": Altitude step in the new altitude grid.
        If "auto", the minimum altitude step is used.</p>
            </div>
          </td>
          <td>
                <code><span title="joseki.profiles.core.DEFAULT_OPTIONS">DEFAULT_OPTIONS</span></code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments passed to the interpolation function.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Regularized atmospheric profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="k">def</span> <span class="nf">regularize</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_METHOD</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">options</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]]</span> <span class="o">=</span> <span class="n">DEFAULT_OPTIONS</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Regularize the profile&#39;s altitude grid.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        ds: Initial atmospheric profile.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        method: Mapping of variable and interpolation method.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            If a variable is not in the mapping, the linear interpolation is used.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            By default, linear interpolation is used for all variables.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        conserve_column: If True, ensure that column densities are conserved.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        options: Options for the regularization.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            Mapping with possible keys:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">                - &quot;num&quot;: Number of points in the new altitude grid.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">                - &quot;zstep&quot;: Altitude step in the new altitude grid.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">                    If &quot;auto&quot;, the minimum altitude step is used.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        kwargs: Keyword arguments passed to the interpolation function.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Regularized atmospheric profile.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">z_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">z</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">options</span><span class="p">[</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">elif</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;zstep&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">zstep</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;zstep&quot;</span><span class="p">]</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">zunits</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">units</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zstep</span><span class="p">,</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="k">pass</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zstep</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="k">if</span> <span class="n">zstep</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="n">zstep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid zstep value: </span><span class="si">{</span><span class="n">zstep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid zstep value: </span><span class="si">{</span><span class="n">zstep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">z_new</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                <span class="n">z</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">zunits</span><span class="p">),</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>                <span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">zunits</span><span class="p">),</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                <span class="n">zstep</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">zunits</span><span class="p">),</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="o">*</span> <span class="n">zunits</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;options must contain either &#39;num&#39; or &#39;zstep&#39; key.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="k">return</span> <span class="n">interp</span><span class="p">(</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">z_new</span><span class="o">=</span><span class="n">z_new</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.core.rescale_to_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">rescale_to_column</span><span class="p">(</span><span class="n">reference</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span></code>

<a href="#joseki.profiles.core.rescale_to_column" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Rescale mole fraction to ensure that column densities are conserved.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>reference</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Reference profile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile to rescale.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Rescaled profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">def</span> <span class="nf">rescale_to_column</span><span class="p">(</span><span class="n">reference</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rescale mole fraction to ensure that column densities are conserved.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        reference: Reference profile.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        ds: Profile to rescale.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        Rescaled profile.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">desired</span> <span class="o">=</span> <span class="n">reference</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">column_number_density</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">actual</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">column_number_density</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">factors</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">reference</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="k">if</span> <span class="n">desired</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">m</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">elif</span> <span class="n">actual</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">m</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="sa">f</span><span class="s2">&quot;Actual column number density of </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> is zero but the reference &quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="sa">f</span><span class="s2">&quot;column number density is not (</span><span class="si">{</span><span class="n">desired</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="si">:</span><span class="s2">~P</span><span class="si">}</span><span class="s2">): rescaling &quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                <span class="sa">f</span><span class="s2">&quot;is impossible.&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">factors</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">desired</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">/</span> <span class="n">actual</span><span class="p">[</span><span class="n">m</span><span class="p">])</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;dimensionless&quot;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="n">factors</span><span class="o">=</span><span class="n">factors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.core.select_molecules" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">select_molecules</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">molecules</span><span class="p">)</span></code>

<a href="#joseki.profiles.core.select_molecules" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Select specified molecules in the profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Initial atmospheric profile.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>molecules</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of molecules to select.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile with exactly the specified molecules.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="k">def</span> <span class="nf">select_molecules</span><span class="p">(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">molecules</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Select specified molecules in the profile.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        ds: Initial atmospheric profile.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        molecules: List of molecules to select.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Atmospheric profile with exactly the specified molecules.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="n">drop_molecules</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">molecules</span> <span class="k">if</span> <span class="n">m</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="n">ds_dropped</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">drop_molecules</span><span class="p">(</span><span class="n">drop_molecules</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">m</span> <span class="ow">in</span> <span class="n">ds_dropped</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">molecules</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]):</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="k">return</span> <span class="n">ds_dropped</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="sa">f</span><span class="s2">&quot;Could not select molecules </span><span class="si">{</span><span class="n">molecules</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="sa">f</span><span class="s2">&quot;available molecules are </span><span class="si">{</span><span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">molecules</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.schema" class="doc doc-heading">
          <code>joseki.profiles.schema</code>


<a href="#joseki.profiles.schema" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Dataset schema for atmosphere thermophysical profiles.</p>
<p>The dataset schema defines the variables, coordinates and attributes that are
expected in a dataset representing an atmosphere thermophysical profile.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.schema.Schema" class="doc doc-heading">
          <code>joseki.profiles.schema.Schema</code>


<a href="#joseki.profiles.schema.Schema" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>Dataset schema for atmosphere thermophysical profiles.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/schema.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="nd">@define</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="k">class</span> <span class="nc">Schema</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataset schema for atmosphere thermophysical profiles.&quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="c1"># name: (dims, data type, dimensionality, standard name)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">data_vars</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>            <span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>            <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="s2">&quot;Pa&quot;</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="s2">&quot;air_pressure&quot;</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="p">),</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>            <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="s2">&quot;K&quot;</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="s2">&quot;air_temperature&quot;</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="p">),</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">],</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="s2">&quot;m ** -3&quot;</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="s2">&quot;air_number_density&quot;</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="p">),</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="p">}</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="s2">&quot;km&quot;</span><span class="p">,</span> <span class="s2">&quot;altitude&quot;</span><span class="p">),</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">}</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="s2">&quot;Conventions&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="s2">&quot;institution&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="s2">&quot;history&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="s2">&quot;urldate&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="p">}</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">ret_true_if_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate dataset.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            ds: Dataset to validate.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            check_x_sum: if True, check that mole fraction sums</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">                are never larger than one.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            ret_true_if_valid: make this method return True if the dataset is</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                valid. Note that if the dataset is not valid, this method will</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">                raise an exception.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            ValueError: If the dataset does not match the schema.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            None or bool: If `ret_true_if_valid` is True, returns True if the</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                dataset is valid, otherwise returns None.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Validating dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that all data variables are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing data variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that &#39;x_*&#39; data variable(s) are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">]):</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="s2">&quot;missing data variable starting with x_&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that all coordinates are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">if</span> <span class="n">coord</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing coordinate: </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that all attributes are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that data variables have the correct dimensions&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dims</span><span class="p">):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect dimensions for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dims</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                    <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                <span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that coordinates have the correct dimensions&quot;</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dims</span><span class="p">):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect dimensions for </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dims</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                    <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that data variables have the correct dimensionality&quot;</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">dimensionality</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">dimensionality</span><span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect units for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                    <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that coordinates have the correct dimensionality&quot;</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">dimensionality</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">dimensionality</span><span class="p">):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect units for </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                    <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that attributes have the correct types&quot;</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="n">typ</span><span class="p">):</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect type for </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                    <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that data variables have the correct standard names&quot;</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">standard_name</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect standard name for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected &quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_name</span><span class="si">}</span><span class="s2">, got &quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="s2">&quot;Checking that all x_* data variables have the correct &quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="s2">&quot;dimensionality and standard names&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="n">units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">):</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                        <span class="sa">f</span><span class="s2">&quot;incorrect dimensionality for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected &quot;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                        <span class="sa">f</span><span class="s2">&quot;dimensionless, got </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                    <span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_mole_fraction&quot;</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                        <span class="sa">f</span><span class="s2">&quot;incorrect standard name for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected &quot;</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_mole_fraction, got &quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                    <span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="k">if</span> <span class="n">check_x_sum</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that mole fraction sums are never larger than one&quot;</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">vfs</span> <span class="o">=</span> <span class="n">mole_fraction_sum</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">vfs</span><span class="o">.</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="s2">&quot;The rescaling factors lead to a profile where the mole &quot;</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                    <span class="s2">&quot;fraction sum is larger than 1.&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dataset is valid&quot;</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">if</span> <span class="n">ret_true_if_valid</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">data_vars</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">],</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">coords</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">],</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">attrs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert input to schema-compliant dataset.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            data_vars: Mapping of data variable names to quantities.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            coords: Mapping of coordinate names to quantities.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            attrs: Mapping of attribute names to values.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            Dataset with schema-compliant data variables, coordinates, and</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            attributes.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting input to schema-compliant dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all data variables are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="n">n</span> <span class="o">=</span> <span class="n">number_density</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                    <span class="n">p</span><span class="o">=</span><span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                    <span class="n">t</span><span class="o">=</span><span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">],</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>                <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                        <span class="sa">f</span><span class="s2">&quot;missing data variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                    <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that there is at least one x_ data variable&quot;</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">]):</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="s2">&quot;missing data variable starting with x_&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all coordinates are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="k">if</span> <span class="n">coord</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing coordinate: </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all attributes are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting data variables to xarray data array tuples&quot;</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                <span class="n">dims</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">units</span><span class="p">),</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>                <span class="p">{</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                    <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="p">},</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting x_ data variables&quot;</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                    <span class="s2">&quot;z&quot;</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                    <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;dimensionless&quot;</span><span class="p">),</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                    <span class="p">{</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_mole_fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> mole fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;dimensionless&quot;</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                    <span class="p">},</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                <span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting coordinates&quot;</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">coords</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="n">attr</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                <span class="n">coords</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">units</span><span class="p">),</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                <span class="p">{</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                    <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                <span class="p">},</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all attributes are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;creating dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="n">data_vars</span><span class="o">=</span><span class="n">data_vars</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h4 id="joseki.profiles.schema.Schema.convert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">Schema</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">data_vars</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></code>

<a href="#joseki.profiles.schema.Schema.convert" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Convert input to schema-compliant dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data_vars</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of data variable names to quantities.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>coords</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, <span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of coordinate names to quantities.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>attrs</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of attribute names to values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset with schema-compliant data variables, coordinates, and</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>attributes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/schema.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">data_vars</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">],</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">coords</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">],</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">attrs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert input to schema-compliant dataset.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        data_vars: Mapping of data variable names to quantities.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        coords: Mapping of coordinate names to quantities.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        attrs: Mapping of attribute names to values.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        Dataset with schema-compliant data variables, coordinates, and</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        attributes.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting input to schema-compliant dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all data variables are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">number_density</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="n">p</span><span class="o">=</span><span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="n">t</span><span class="o">=</span><span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">],</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                    <span class="sa">f</span><span class="s2">&quot;missing data variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that there is at least one x_ data variable&quot;</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">]):</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="s2">&quot;missing data variable starting with x_&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all coordinates are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">if</span> <span class="n">coord</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing coordinate: </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all attributes are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting data variables to xarray data array tuples&quot;</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">dims</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">units</span><span class="p">),</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="p">{</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="p">},</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting x_ data variables&quot;</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                <span class="s2">&quot;z&quot;</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                <span class="n">data_vars</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;dimensionless&quot;</span><span class="p">),</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="p">{</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_mole_fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2"> mole fraction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;dimensionless&quot;</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                <span class="p">},</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting coordinates&quot;</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">coords</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="n">attr</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="n">coords</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="n">units</span><span class="p">),</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="p">{</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="n">standard_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">),</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">units</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="p">},</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;checking that all attributes are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;creating dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">data_vars</span><span class="o">=</span><span class="n">data_vars</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h4 id="joseki.profiles.schema.Schema.validate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">Schema</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">check_x_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ret_true_if_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#joseki.profiles.schema.Schema.validate" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Validate dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>check_x_sum</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if True, check that mole fraction sums
are never larger than one.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>ret_true_if_valid</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>make this method return True if the dataset is
valid. Note that if the dataset is not valid, this method will
raise an exception.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the dataset does not match the schema.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Optional">Optional</span>[bool]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None or bool: If <code>ret_true_if_valid</code> is True, returns True if the
dataset is valid, otherwise returns None.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/schema.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">ret_true_if_valid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate dataset.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        ds: Dataset to validate.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        check_x_sum: if True, check that mole fraction sums</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            are never larger than one.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ret_true_if_valid: make this method return True if the dataset is</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            valid. Note that if the dataset is not valid, this method will</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            raise an exception.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        ValueError: If the dataset does not match the schema.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        None or bool: If `ret_true_if_valid` is True, returns True if the</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            dataset is valid, otherwise returns None.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Validating dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that all data variables are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing data variable: </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that &#39;x_*&#39; data variable(s) are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">]):</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="s2">&quot;missing data variable starting with x_&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that all coordinates are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">if</span> <span class="n">coord</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing coordinate: </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that all attributes are present&quot;</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="k">if</span> <span class="n">attr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that data variables have the correct dimensions&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dims</span><span class="p">):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="sa">f</span><span class="s2">&quot;incorrect dimensions for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dims</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that coordinates have the correct dimensions&quot;</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dims</span><span class="p">):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="sa">f</span><span class="s2">&quot;incorrect dimensions for </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dims</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that data variables have the correct dimensionality&quot;</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">dimensionality</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">dimensionality</span><span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="sa">f</span><span class="s2">&quot;incorrect units for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that coordinates have the correct dimensionality&quot;</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">dimensionality</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">dimensionality</span><span class="p">):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="sa">f</span><span class="s2">&quot;incorrect units for </span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that attributes have the correct types&quot;</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">typ</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">],</span> <span class="n">typ</span><span class="p">):</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="sa">f</span><span class="s2">&quot;incorrect type for </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">. Expected </span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="sa">f</span><span class="s2">&quot;got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that data variables have the correct standard names&quot;</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">standard_name</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">standard_name</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="sa">f</span><span class="s2">&quot;incorrect standard name for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected &quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">standard_name</span><span class="si">}</span><span class="s2">, got &quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="s2">&quot;Checking that all x_* data variables have the correct &quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="s2">&quot;dimensionality and standard names&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">units</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">units</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[]&quot;</span><span class="p">):</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect dimensionality for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected &quot;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                    <span class="sa">f</span><span class="s2">&quot;dimensionless, got </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">dimensionality</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_mole_fraction&quot;</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                    <span class="sa">f</span><span class="s2">&quot;incorrect standard name for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">. Expected &quot;</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">_mole_fraction, got &quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">if</span> <span class="n">check_x_sum</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Checking that mole fraction sums are never larger than one&quot;</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">vfs</span> <span class="o">=</span> <span class="n">mole_fraction_sum</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">vfs</span><span class="o">.</span><span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="s2">&quot;The rescaling factors lead to a profile where the mole &quot;</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="s2">&quot;fraction sum is larger than 1.&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dataset is valid&quot;</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">if</span> <span class="n">ret_true_if_valid</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.schema.mole_fraction_sum" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">mole_fraction_sum</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span></code>

<a href="#joseki.profiles.schema.mole_fraction_sum" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute the sum of mole fractions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The sum of mole fractions.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/schema.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="k">def</span> <span class="nf">mole_fraction_sum</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the sum of mole fractions.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        ds: Dataset.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        The sum of mole fractions.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="nb">sum</span><span class="p">([</span><span class="n">ds</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)])</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">dimensionless</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.afgl_1986" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986</code>


<a href="#joseki.profiles.afgl_1986" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>AFGL 1986 atmosphere's thermophysical profiles.</p>
<p>The profiles are generated from data files stored in <code>joseki/data/afgl_1986</code>.
These data files correspond to tables 1a-f and 2a-d of the technical report
<a href="../bibliography/#Anderson+1986">Anderson+1986</a>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.AFGL1986MidlatitudeSummer" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.AFGL1986MidlatitudeSummer</code>


<a href="#joseki.profiles.afgl_1986.AFGL1986MidlatitudeSummer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>AFGL 1986 midlatitude summer atmosphere thermophysical profile.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;afgl_1986-midlatitude_summer&quot;</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="nd">@define</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="k">class</span> <span class="nc">AFGL1986MidlatitudeSummer</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 midlatitude summer atmosphere thermophysical profile.&quot;&quot;&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="s2">&quot;creating AFGL 1986 midlatitude summer atmosphere thermophysical &quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="s2">&quot;profile dataset.&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">MIDLATITUDE_SUMMER</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.AFGL1986MidlatitudeWinter" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.AFGL1986MidlatitudeWinter</code>


<a href="#joseki.profiles.afgl_1986.AFGL1986MidlatitudeWinter" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>AFGL 1986 midlatitude winter atmosphere thermophysical profile.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;afgl_1986-midlatitude_winter&quot;</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="nd">@define</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="k">class</span> <span class="nc">AFGL1986MidlatitudeWinter</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 midlatitude winter atmosphere thermophysical profile.&quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="s2">&quot;creating AFGL 1986 midlatitude winter atmosphere thermophysical &quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="s2">&quot;profile dataset.&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">MIDLATITUDE_WINTER</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.AFGL1986SubarcticSummer" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.AFGL1986SubarcticSummer</code>


<a href="#joseki.profiles.afgl_1986.AFGL1986SubarcticSummer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>AFGL 1986 subarctic summer atmosphere thermophysical profile.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;afgl_1986-subarctic_summer&quot;</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="nd">@define</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="k">class</span> <span class="nc">AFGL1986SubarcticSummer</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 subarctic summer atmosphere thermophysical profile.&quot;&quot;&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="s2">&quot;creating AFGL 1986 subarctic summer atmosphere thermophysical &quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="s2">&quot;profile dataset.&quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">SUBARCTIC_SUMMER</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.AFGL1986SubarcticWinter" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.AFGL1986SubarcticWinter</code>


<a href="#joseki.profiles.afgl_1986.AFGL1986SubarcticWinter" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>AFGL 1986 subarctic winter atmosphere thermophysical profile.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;afgl_1986-subarctic_winter&quot;</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="nd">@define</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="k">class</span> <span class="nc">AFGL1986SubarcticWinter</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 subarctic winter atmosphere thermophysical profile.&quot;&quot;&quot;</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="s2">&quot;creating AFGL 1986 subarctic winter atmosphere thermophysical &quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="s2">&quot;profile dataset.&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">SUBARCTIC_WINTER</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.AFGL1986Tropical" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.AFGL1986Tropical</code>


<a href="#joseki.profiles.afgl_1986.AFGL1986Tropical" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>AFGL 1986 tropical atmosphere thermophysical profile.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;afgl_1986-tropical&quot;</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="nd">@define</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="k">class</span> <span class="nc">AFGL1986Tropical</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 tropical atmosphere thermophysical profile.&quot;&quot;&quot;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="s2">&quot;creating AFGL 1986 tropical atmosphere thermophysical profile dataset.&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">TROPICAL</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.AFGL1986USStandard" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.AFGL1986USStandard</code>


<a href="#joseki.profiles.afgl_1986.AFGL1986USStandard" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>AFGL 1986 US Standard atmosphere thermophysical profile.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;afgl_1986-us_standard&quot;</span><span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="nd">@define</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="k">class</span> <span class="nc">AFGL1986USStandard</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 US Standard atmosphere thermophysical profile.&quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="s2">&quot;creating AFGL 1986 US Standard atmosphere thermophysical profile dataset.&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">US_STANDARD</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.afgl_1986.Identifier" class="doc doc-heading">
          <code>joseki.profiles.afgl_1986.Identifier</code>


<a href="#joseki.profiles.afgl_1986.Identifier" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>AFGL 1986 atmospheric profile identifier enumeration.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">class</span> <span class="nc">Identifier</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AFGL 1986 atmospheric profile identifier enumeration.&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">TROPICAL</span> <span class="o">=</span> <span class="s2">&quot;tropical&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">MIDLATITUDE_SUMMER</span> <span class="o">=</span> <span class="s2">&quot;midlatitude_summer&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">MIDLATITUDE_WINTER</span> <span class="o">=</span> <span class="s2">&quot;midlatitude_winter&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">SUBARCTIC_SUMMER</span> <span class="o">=</span> <span class="s2">&quot;subarctic_summer&quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">SUBARCTIC_WINTER</span> <span class="o">=</span> <span class="s2">&quot;subarctic_winter&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">US_STANDARD</span> <span class="o">=</span> <span class="s2">&quot;us_standard&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.afgl_1986.dataframe_to_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">afgl_1986</span><span class="o">.</span><span class="n">dataframe_to_dataset</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">additional_molecules</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#joseki.profiles.afgl_1986.dataframe_to_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Convert the output of the <code>parse</code> method to a <code>xarray.Dataset</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.afgl_1986.Identifier" href="#joseki.profiles.afgl_1986.Identifier">Identifier</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile identifier.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>additional_molecules</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, include molecules 8-28 as numbered
in <a href="../bibliography/#Anderson+1986">Anderson+1986</a>.
Else, discard molecules 8-28.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>Use the <code>z</code> column of the output pandas.DataFrame of read_raw_data
as data coordinate and all other columns as data variables.
All data variables and coordinates of the returned xarray.Dataset are
associated metadata (standard name, long name and units).
Raw data units are documented in the technical report <em>AFGL Atmospheric
Constituent Profiles (0-120 km)</em>, Anderson et al., 1986
<a href="../bibliography/#Anderson+1986">Anderson+1986</a>.
dataset attributes are added.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="k">def</span> <span class="nf">dataframe_to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">additional_molecules</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the output of the `parse` method to a `xarray.Dataset`.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        df: Atmospheric profile data.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        identifier: Atmospheric profile identifier.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        additional_molecules: If ``True``, include molecules 8-28 as numbered</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            in [Anderson+1986](bibliography.md#Anderson+1986).</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            Else, discard molecules 8-28.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        Atmospheric profile dataset.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        Use the ``z`` column of the output pandas.DataFrame of read_raw_data</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        as data coordinate and all other columns as data variables.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        All data variables and coordinates of the returned xarray.Dataset are</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        associated metadata (standard name, long name and units).</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Raw data units are documented in the technical report *AFGL Atmospheric</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Constituent Profiles (0-120 km)*, Anderson et al., 1986</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        [Anderson+1986](bibliography.md#Anderson+1986).</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        dataset attributes are added.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="c1"># list molecules</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="c1"># molecules labels correspond to column with upper case first letter in</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="c1"># raw data DataFrames</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">molecules</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">if</span> <span class="n">column</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">molecules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">if</span> <span class="n">additional_molecules</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">pass</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">molecules</span> <span class="o">=</span> <span class="n">molecules</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1"># coordinates</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;km&quot;</span><span class="p">)}</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="c1"># data variables</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">data_vars</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;millibar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;Pa&quot;</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;cm^-3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;m^-3&quot;</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">df</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">ppm</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="p">)</span>  <span class="c1"># raw data mole fraction are given in ppmv</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="c1"># attributes</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">pretty_identifier</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;AFGL (1986) </span><span class="si">{</span><span class="n">identifier</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">pretty_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pretty_identifier</span><span class="si">}</span><span class="s2"> atmosphere thermophysical profile&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="s2">&quot;Conventions&quot;</span><span class="p">:</span> <span class="s2">&quot;CF-1.10&quot;</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">pretty_title</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="s2">&quot;institution&quot;</span><span class="p">:</span> <span class="n">INSTITUION</span><span class="p">,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">SOURCE</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="s2">&quot;history&quot;</span><span class="p">:</span> <span class="n">history</span><span class="p">(),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="n">REFERENCE</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">URL</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="s2">&quot;urldate&quot;</span><span class="p">:</span> <span class="n">URLDATE</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="p">}</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">return</span> <span class="n">schema</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">data_vars</span><span class="o">=</span><span class="n">data_vars</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.afgl_1986.get_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">afgl_1986</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">additional_molecules</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#joseki.profiles.afgl_1986.get_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Read data files for a given atmospheric profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.afgl_1986.Identifier" href="#joseki.profiles.afgl_1986.Identifier">Identifier</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile identifier.
See
<a href="./#src.joseki.profiles.afgl_1986.Identifier"><code>Identifier</code></a>
for possible values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>additional_molecules</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, include molecules 8-28 as numbered in
<a href="../bibliography/#Anderson+1986">Anderson+1986</a>.
Else, discard molecules 8-28.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>Chain calls to
<a href="./#src.joseki.profiles.afgl_1986.parse"><code>parse</code></a> and
<a href="./#src.joseki.profiles.afgl_1986.dataframe_to_dataset"><code>dataframe_to_dataset</code></a>.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="k">def</span> <span class="nf">get_dataset</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">additional_molecules</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read data files for a given atmospheric profile.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        identifier: Atmospheric profile identifier.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            See</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            [`Identifier`](reference.md#src.joseki.profiles.afgl_1986.Identifier)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            for possible values.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        additional_molecules: If ``True``, include molecules 8-28 as numbered in</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            [Anderson+1986](bibliography.md#Anderson+1986).</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            Else, discard molecules 8-28.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Atmospheric profile dataset.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Chain calls to</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        [`parse`](reference.md#src.joseki.profiles.afgl_1986.parse) and</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        [`dataframe_to_dataset`](reference.md#src.joseki.profiles.afgl_1986.dataframe_to_dataset).</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">return</span> <span class="n">dataframe_to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">additional_molecules</span><span class="o">=</span><span class="n">additional_molecules</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.afgl_1986.parse" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">afgl_1986</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span></code>

<a href="#joseki.profiles.afgl_1986.parse" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse table data files for a given atmospheric profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.afgl_1986.Identifier" href="#joseki.profiles.afgl_1986.Identifier">Identifier</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile identifier.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>Read the relevant raw data files corresponding to the atmospheric profile.
These raw data files correspond to tables 1 and 2 from the
technical report <a href="../bibliography/#Anderson+1986"><em>AFGL Atmospheric Constituent Profiles (0-120 km)</em>,
Anderson et al., 1986</a>.
Each atmospheric profile has 5 tables, i.e. 5 raw data files, associated
to it.
Only the first of these tables is specific to each atmospheric profile.
All 5 raw data files are read into <code>pandas.DataFrame</code> objects and
then concatenated after dropping the duplicate columns.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse table data files for a given atmospheric profile.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        identifier: Atmospheric profile identifier.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        Atmospheric profile dataset.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        Read the relevant raw data files corresponding to the atmospheric profile.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        These raw data files correspond to tables 1 and 2 from the</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        technical report [*AFGL Atmospheric Constituent Profiles (0-120 km)*,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        Anderson et al., 1986](bibliography.md#Anderson+1986).</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        Each atmospheric profile has 5 tables, i.e. 5 raw data files, associated</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        to it.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        Only the first of these tables is specific to each atmospheric profile.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        All 5 raw data files are read into `pandas.DataFrame` objects and</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        then concatenated after dropping the duplicate columns.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">package</span> <span class="o">=</span> <span class="s2">&quot;joseki.data.afgl_1986&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">files</span> <span class="o">=</span> <span class="n">DATA_FILES</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">csvfile</span> <span class="o">=</span> <span class="n">importlib_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">package</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">dataframes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span> <span class="s2">&quot;O3&quot;</span><span class="p">,</span> <span class="s2">&quot;N2O&quot;</span><span class="p">,</span> <span class="s2">&quot;CO&quot;</span><span class="p">,</span> <span class="s2">&quot;CH4&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.afgl_1986.to_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">afgl_1986</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interp_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.profiles.afgl_1986.to_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Helper Profile.to_dataset() method.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.afgl_1986.Identifier" href="#joseki.profiles.afgl_1986.Identifier">Identifier</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>AFGL 1986 atmosphere thermophysical profile identifier.
See
<a href="./#src.joseki.profiles.afgl_1986.Identifier"><code>Identifier</code></a>
for possible values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>z</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="pint.Quantity">Quantity</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New level altitudes.
If <code>None</code>, return the original dataset
Else, interpolate the dataset to the new level altitudes.
Default is <code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>interp_method</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Interpolation method for each data variable. Default is
<code>None</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_column</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, ensure that column densities are conserved
during interpolation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional arguments passed to
<a href="./#src.joseki.profiles.afgl_1986.get_dataset"><code>get_dataset</code></a>.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmosphere thermophysical profile dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/afgl_1986.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Helper Profile.to_dataset() method.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        identifier: AFGL 1986 atmosphere thermophysical profile identifier.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            See</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            [`Identifier`](reference.md#src.joseki.profiles.afgl_1986.Identifier)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">            for possible values.</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        z: New level altitudes.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">            If ``None``, return the original dataset</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">            Else, interpolate the dataset to the new level altitudes.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            Default is ``None``.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        interp_method: Interpolation method for each data variable. Default is</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            ``None``.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        conserve_column: If `True`, ensure that column densities are conserved</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            during interpolation.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        kwargs: Additional arguments passed to</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            [`get_dataset`](reference.md#src.joseki.profiles.afgl_1986.get_dataset).</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Atmosphere thermophysical profile dataset.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="c1"># Get additional_molecules from kwargs</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">additional_molecules</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;additional_molecules&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1"># kwargs different than &#39;additional_molecules&#39; are ignored</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="s2">&quot;additional_molecules&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="s2">&quot;Ignoring kwargs different than &#39;additional_molecules&#39;. &quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="s2">&quot;(got </span><span class="si">%s</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="s2">&quot;Use &#39;additional_molecules&#39; to include molecules 8-28 &quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="s2">&quot;as numbered in Anderson et al. (1986).&quot;</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="c1"># Get the original dataset</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">additional_molecules</span><span class="o">=</span><span class="n">additional_molecules</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="c1"># Interpolate if necessary</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">method</span> <span class="o">=</span> <span class="n">interp_method</span> <span class="k">if</span> <span class="n">interp_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">DEFAULT_METHOD</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">z_new</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">return</span> <span class="n">ds</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">return</span> <span class="n">ds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.mipas_2007" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007</code>


<a href="#joseki.profiles.mipas_2007" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>MIPAS atmosphere thermophysical profiles.</p>
<p><a href="../bibliography/#Remedios+2007">Remedios et al. (2007)</a> define a set of 5
"standard atmospheres" representing the atmosphere at different latitudes and
seasons or times of day:</p>
<ul>
<li>midlatitude day</li>
<li>midlatitude night</li>
<li>polar winter</li>
<li>polar summer</li>
<li>tropical</li>
</ul>
<p>MIPAS standard atmospheres were intended to provide an updated set of pro-
files for characteristic atmospheric states such as the
<a href="../bibliography/#Anderson+1986">AFGL Atmospheric constituent profiles</a>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.mipas_2007.Identifier" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007.Identifier</code>


<a href="#joseki.profiles.mipas_2007.Identifier" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>MIPAS atmosphere thermophysical profile identifier enumeration.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">class</span> <span class="nc">Identifier</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MIPAS atmosphere thermophysical profile identifier enumeration.&quot;&quot;&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">MIDLATITUDE_DAY</span> <span class="o">=</span> <span class="s2">&quot;midlatitude_day&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">MIDLATITUDE_NIGHT</span> <span class="o">=</span> <span class="s2">&quot;midlatitude_night&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">POLAR_WINTER</span> <span class="o">=</span> <span class="s2">&quot;polar_winter&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">POLAR_SUMMER</span> <span class="o">=</span> <span class="s2">&quot;polar_summer&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">TROPICAL</span> <span class="o">=</span> <span class="s2">&quot;tropical&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.mipas_2007.MIPASMidlatitudeDay" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007.MIPASMidlatitudeDay</code>


<a href="#joseki.profiles.mipas_2007.MIPASMidlatitudeDay" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>MIPAS midlatitude day reference atmosphere.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;mipas_2007-midlatitude_day&quot;</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="nd">@define</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="k">class</span> <span class="nc">MIPASMidlatitudeDay</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MIPAS midlatitude day reference atmosphere.&quot;&quot;&quot;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">MIDLATITUDE_DAY</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="n">method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.mipas_2007.MIPASMidlatitudeNight" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007.MIPASMidlatitudeNight</code>


<a href="#joseki.profiles.mipas_2007.MIPASMidlatitudeNight" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>MIPAS Midlatitude night reference atmosphere.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;mipas_2007-midlatitude_night&quot;</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="nd">@define</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="k">class</span> <span class="nc">MIPASMidlatitudeNight</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MIPAS Midlatitude night reference atmosphere.&quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">MIDLATITUDE_NIGHT</span><span class="p">,</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="n">method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.mipas_2007.MIPASPolarSummer" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007.MIPASPolarSummer</code>


<a href="#joseki.profiles.mipas_2007.MIPASPolarSummer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>MIPAS Polar summer reference atmosphere.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;mipas_2007-polar_summer&quot;</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="nd">@define</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="k">class</span> <span class="nc">MIPASPolarSummer</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MIPAS Polar summer reference atmosphere.&quot;&quot;&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">POLAR_SUMMER</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.mipas_2007.MIPASPolarWinter" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007.MIPASPolarWinter</code>


<a href="#joseki.profiles.mipas_2007.MIPASPolarWinter" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>MIPAS Polar winter reference atmosphere.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;mipas_2007-polar_winter&quot;</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="nd">@define</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="k">class</span> <span class="nc">MIPASPolarWinter</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MIPAS Polar winter reference atmosphere.&quot;&quot;&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">POLAR_WINTER</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>

<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.mipas_2007.MIPASTropical" class="doc doc-heading">
          <code>joseki.profiles.mipas_2007.MIPASTropical</code>


<a href="#joseki.profiles.mipas_2007.MIPASTropical" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>MIPAS Tropical reference atmosphere.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;mipas_2007-tropical&quot;</span><span class="p">)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="nd">@define</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="k">class</span> <span class="nc">MIPASTropical</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;MIPAS Tropical reference atmosphere.&quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">return</span> <span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="n">identifier</span><span class="o">=</span><span class="n">Identifier</span><span class="o">.</span><span class="n">TROPICAL</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.get_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">get_dataset</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.get_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Read MIPAS reference atmosphere data files into an xarray.Dataset.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.mipas_2007.Identifier" href="#joseki.profiles.mipas_2007.Identifier">Identifier</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile identifier.
See
<a href="./#src.joseki.profiles.mipas_2007.Identifier"><code>Identifier</code></a>
for possible values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="k">def</span> <span class="nf">get_dataset</span><span class="p">(</span><span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read MIPAS reference atmosphere data files into an xarray.Dataset.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        identifier: Atmospheric profile identifier.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            See</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            [`Identifier`](reference.md#src.joseki.profiles.mipas_2007.Identifier)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            for possible values.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Atmospheric profile.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">content</span> <span class="o">=</span> <span class="n">read_file_content</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">quantities</span> <span class="o">=</span> <span class="n">parse_content</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="c1"># Coordinates</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">quantities</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)}</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="c1"># Data variables</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">data_vars</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">quantities</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">quantities</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># perfect gas equation</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">data_vars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">quantities</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;data variables: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data_vars</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="c1"># Attributes</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">pretty_id</span> <span class="o">=</span> <span class="n">identifier</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">pretty_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MIPAS </span><span class="si">{</span><span class="n">pretty_id</span><span class="si">}</span><span class="s2"> Reference Atmosphere&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="s2">&quot;Conventions&quot;</span><span class="p">:</span> <span class="s2">&quot;CF-1.10&quot;</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="s2">&quot;history&quot;</span><span class="p">:</span> <span class="n">history</span><span class="p">(),</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">pretty_title</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">SOURCE</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="s2">&quot;institution&quot;</span><span class="p">:</span> <span class="n">INSTITUTION</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="n">REFERENCE</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">URL</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="s2">&quot;urldate&quot;</span><span class="p">:</span> <span class="n">URL_DATE</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="p">}</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="c1"># Dataset</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">data_vars</span><span class="o">=</span><span class="n">data_vars</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="p">)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">return</span> <span class="n">ds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.parse_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">parse_content</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.parse_content" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse lines.</p>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="k">def</span> <span class="nf">parse_content</span><span class="p">(</span><span class="n">lines</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse lines.&quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Parsing file content&quot;</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">quantities</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">def</span> <span class="nf">_add_to_quantities</span><span class="p">(</span><span class="n">quantity</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">if</span> <span class="n">quantity</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">quantities</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantity</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;dimensionless&quot;</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">quantities</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantity</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">var</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">values</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">while</span> <span class="n">line</span> <span class="o">!=</span> <span class="s2">&quot;*END&quot;</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">):</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="k">pass</span>  <span class="c1"># this is a comment, ignore the line</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="c1"># convert previously read values (if any) and units to quantity</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="n">quantity</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                    <span class="n">units</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="n">_add_to_quantities</span><span class="p">(</span><span class="n">quantity</span><span class="o">=</span><span class="n">quantity</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="c1"># this is a variable line, parse variable name and units</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">var</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="n">parse_var_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="c1"># following lines are the variables values so prepare a variable</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="c1"># to store the values</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="k">if</span> <span class="s2">&quot;!&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="c1"># this the line with the number of profile levels, ignore it</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="k">pass</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="c1"># this line contains variable values</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="n">values</span> <span class="o">+=</span> <span class="n">parse_values_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="c1"># include last array of values before the &#39;*END&#39; line</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">quantity</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">units</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">_add_to_quantities</span><span class="p">(</span><span class="n">quantity</span><span class="o">=</span><span class="n">quantity</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">return</span> <span class="n">quantities</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.parse_units" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">parse_units</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.parse_units" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse units.</p>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">def</span> <span class="nf">parse_units</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse units.&quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">):</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">units</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;mb&quot;</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="k">return</span> <span class="s2">&quot;millibar&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="k">return</span> <span class="n">units</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot parse units &#39;</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.parse_values_line" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">parse_values_line</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.parse_values_line" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse a line with numeric values.</p>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span> <span class="nf">parse_values_line</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a line with numeric values.&quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>  <span class="c1"># delimiter is comma and whitespace combined</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">s_strip</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="k">if</span> <span class="n">s_strip</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;,&quot;</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">s_strip</span> <span class="o">=</span> <span class="n">s_strip</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s_strip</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># delimiter is whitespace</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.parse_var_line" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">parse_var_line</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.parse_var_line" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse a line with the declaration of a variable and its units.</p>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span> <span class="nf">parse_var_line</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a line with the declaration of a variable and its units.&quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">parts</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">var_name</span><span class="p">,</span> <span class="n">units_s</span> <span class="o">=</span> <span class="n">parts</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">var_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">units_s</span> <span class="o">=</span> <span class="n">parts</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid line format: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">var</span> <span class="o">=</span> <span class="n">parse_var_name</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">units</span> <span class="o">=</span> <span class="n">parse_units</span><span class="p">(</span><span class="n">units_s</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">return</span> <span class="n">var</span><span class="p">,</span> <span class="n">units</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.parse_var_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">parse_var_name</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.parse_var_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse variable name.</p>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="k">def</span> <span class="nf">parse_var_name</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse variable name.&quot;&quot;&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">translate</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;HGT&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;PRE&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;TEM&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">}</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">translate</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">return</span> <span class="n">translate</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">return</span> <span class="n">to_chemical_formula</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.read_file_content" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">read_file_content</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.read_file_content" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Read data file content.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="joseki.profiles.mipas_2007.Identifier" href="#joseki.profiles.mipas_2007.Identifier">Identifier</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Atmospheric profile identifier.
See
<a href="./#src.joseki.profiles.mipas_2007.Identifier"><code>Identifier</code></a>
for possible values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>file content, URL, URL date.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="k">def</span> <span class="nf">read_file_content</span><span class="p">(</span><span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    Read data file content.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        identifier: Atmospheric profile identifier.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            See</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            [`Identifier`](reference.md#src.joseki.profiles.mipas_2007.Identifier)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            for possible values.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        file content, URL, URL date.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">package</span> <span class="o">=</span> <span class="s2">&quot;joseki.data.mipas_2007&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">identifier</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">.atm&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reading file </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">return</span> <span class="n">importlib_resources</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">package</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.to_chemical_formula" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">to_chemical_formula</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.to_chemical_formula" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Convert to chemical formula.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Molecule name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Molecule formula.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>If molecule name is unknown, returns name unchanged.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="k">def</span> <span class="nf">to_chemical_formula</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to chemical formula.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        name: Molecule name.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        Molecule formula.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        If molecule name is unknown, returns name unchanged.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">return</span> <span class="n">translate_cfc</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">return</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.to_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.to_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Helper for <code>Profile.to_dataset</code> method</p>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="n">Identifier</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper for `Profile.to_dataset` method&quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="c1"># no kwargs are expected</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unexpected keyword arguments: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="c1"># get original MIPAS midlatitude day reference atmosphere</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Get original MIPAS midlatitude day reference atmosphere&quot;</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="c1"># Interpolate to new vertical grid if necessary</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">method</span> <span class="o">=</span> <span class="n">DEFAULT_METHOD</span> <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">method</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">interp</span><span class="p">(</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="n">z_new</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="p">)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="k">return</span> <span class="n">ds</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="k">return</span> <span class="n">ds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.mipas_2007.translate_cfc" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">mipas_2007</span><span class="o">.</span><span class="n">translate_cfc</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#joseki.profiles.mipas_2007.translate_cfc" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Convert chlorofulorocarbon name to corresponding chemical formula.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Chlorofulorocarbon name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Chlorofulorocarbon chemical formula.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the name does not match a known chlorofulorocarbon.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/mipas_2007.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="k">def</span> <span class="nf">translate_cfc</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert chlorofulorocarbon name to corresponding chemical formula.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        name: Chlorofulorocarbon name.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        Chlorofulorocarbon chemical formula.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        ValueError: If the name does not match a known chlorofulorocarbon.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">for</span> <span class="n">formula</span><span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">CFC_FORMULAE</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="k">return</span> <span class="n">formula</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown chlorofulorocarbon </span><span class="si">{name}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.ussa_1976" class="doc doc-heading">
          <code>joseki.profiles.ussa_1976</code>


<a href="#joseki.profiles.ussa_1976" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Module to compute the U.S. Standard Atmosphere 1976.</p>
<p>The U.S. Standard Atmosphere 1976 is a Earth atmosphere thermophysical model
described in the technical report <a href="../bibliography/#NOAA+1976">NOAA+1976</a>.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h3 id="joseki.profiles.ussa_1976.USSA1976" class="doc doc-heading">
          <code>joseki.profiles.ussa_1976.USSA1976</code>


<a href="#joseki.profiles.ussa_1976.USSA1976" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="joseki.profiles.core.Profile" href="#joseki.profiles.core.Profile">Profile</a></code></p>

  
      <p>Class to compute the U.S. Standard Atmosphere 1976.</p>
<p>The U.S. Standard Atmosphere 1976 is a Earth atmosphere thermophysical model
described in the technical report <a href="../bibliography/#NOAA+1976">NOAA+1976</a>.</p>

            <details class="quote">
              <summary>Source code in <code>src/joseki/profiles/ussa_1976.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="nd">@factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;ussa_1976&quot;</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="nd">@define</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">class</span> <span class="nc">USSA1976</span><span class="p">(</span><span class="n">Profile</span><span class="p">):</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Class to compute the U.S. Standard Atmosphere 1976.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    The U.S. Standard Atmosphere 1976 is a Earth atmosphere thermophysical model</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    described in the technical report [NOAA+1976](bibliography.md#NOAA+1976).</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">def</span> <span class="nf">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">z</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="c1"># Since the ussa_1976 model can be evaluated at any altitude, both</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="c1"># interp_method and conserve_column are ignored.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="c1"># kwargs are ignored</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                <span class="s2">&quot;value of the &#39;kwargs&#39; parameter will be ignored.&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="c1"># variable to compute with the ussa1976 package</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="s2">&quot;p&quot;</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="s2">&quot;t&quot;</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="s2">&quot;n_tot&quot;</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="s2">&quot;n&quot;</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="p">]</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="c1"># compute profile</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Computing profile with ussa1976 package&quot;</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="n">ds</span> <span class="o">=</span> <span class="n">ussa1976</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Computing profile with ussa1976 package&quot;</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;z=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">ds</span> <span class="o">=</span> <span class="n">ussa1976</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">),</span> <span class="n">variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="c1"># extract data</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;km&quot;</span><span class="p">)}</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">data_vars</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;Pa&quot;</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">data_vars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;n_tot&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;m^-3&quot;</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="c1"># compute mole fraction</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;s&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">nx</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">))</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="n">n_tot</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;n_tot&quot;</span><span class="p">])</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="n">data_vars</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span> <span class="o">/</span> <span class="n">n_tot</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;dimensionless&quot;</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="s2">&quot;Conventions&quot;</span><span class="p">:</span> <span class="s2">&quot;CF-1.10&quot;</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;U.S. Standard Atmosphere 1976&quot;</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="s2">&quot;institution&quot;</span><span class="p">:</span> <span class="s2">&quot;NOAA&quot;</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="s2">&quot;history&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">history</span><span class="p">(),</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;references&quot;</span><span class="p">],</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://ntrs.nasa.gov/citations/19770009539&quot;</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="s2">&quot;urldate&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-12-08&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="p">}</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">data_vars</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="n">coords</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">attrs</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">return</span> <span class="n">ds</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.util" class="doc doc-heading">
          <code>joseki.profiles.util</code>


<a href="#joseki.profiles.util" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Utility module.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.util.air_molar_mass_from_mass_fraction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">air_molar_mass_from_mass_fraction</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>

<a href="#joseki.profiles.util.air_molar_mass_from_mass_fraction" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute the air molar mass from the of air constituents mass fractions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mass fraction as a function of molecule (<code>m</code>) and altitude (<code>z</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air molar mass as a function of altitude (<code>z</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The air molar mass is computed according to the following equation:</p>
<div class="arithmatex">\[
m_{\mathrm{air}} (z) = \left(
    \sum_{\mathrm{M}} \frac{
        y_{\mathrm{M}} (z)
    }{
        m_{\mathrm{M}}
    }
\right)^{-1}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_{\mathrm{M}} (z)\)</span> is the mass fraction of molecule M at altitude
  <span class="arithmatex">\(z\)</span>,</li>
<li><span class="arithmatex">\(m_{\mathrm{M}}\)</span> is the molar mass of molecule M.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">def</span> <span class="nf">air_molar_mass_from_mass_fraction</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    Compute the air molar mass from the of air constituents mass fractions.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        y: Mass fraction as a function of molecule (`m`) and altitude (`z`).</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        Air molar mass as a function of altitude (`z`).</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        The air molar mass is computed according to the following equation:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        $$</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        m_{\mathrm{air}} (z) = \left(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            \sum_{\mathrm{M}} \frac{</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">                y_{\mathrm{M}} (z)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            }{</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">                m_{\mathrm{M}}</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            }</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        \right)^{-1}</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        $$</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        where:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        * $y_{\mathrm{M}} (z)$ is the mass fraction of molecule M at altitude</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">          $z$,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        * $m_{\mathrm{M}}$ is the molar mass of molecule M.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># compute molar masses along molecular species</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">molecules</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">mm</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">MM</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">],</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">molecules</span><span class="p">)},</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="c1"># compute air molar mass</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">mm_inv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">mm</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">weighted_mean_mm_inv</span> <span class="o">=</span> <span class="p">(</span><span class="n">mm_inv</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">mm_air</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">weighted_mean_mm_inv</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">mm_air</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;g/mol&quot;</span><span class="p">})</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">return</span> <span class="n">mm_air</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.util.number_density" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">number_density</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span></code>

<a href="#joseki.profiles.util.number_density" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute air number density from air pressure and air temperature.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air pressure.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>t</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air temperature.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number density.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The air number density is computed according to the ideal gas law:</p>
<div class="arithmatex">\[
n = \frac{p}{k_B T}
\]</div>
<p>where <span class="arithmatex">\(p\)</span> is the air pressure, <span class="arithmatex">\(k_B\)</span> is the Boltzmann constant, and
<span class="arithmatex">\(T\)</span> is the air temperature.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span> <span class="nf">number_density</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute air number density from air pressure and air temperature.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        p: Air pressure.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        t: Air temperature.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        Number density.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        The air number density is computed according to the ideal gas law:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        $$</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        n = \\frac{p}{k_B T}</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        $$</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        where $p$ is the air pressure, $k_B$ is the Boltzmann constant, and</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        $T$ is the air temperature.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.util.utcnow" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span></code>

<a href="#joseki.profiles.util.utcnow" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get current UTC time.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ISO 8601 formatted UTC timestamp.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="k">def</span> <span class="nf">utcnow</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current UTC time.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        ISO 8601 formatted UTC timestamp.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.core" class="doc doc-heading">
          <code>joseki.core</code>


<a href="#joseki.core" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Core module.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="joseki.core.identifiers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">identifiers</span><span class="p">()</span></code>

<a href="#joseki.core.identifiers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List all registered profile identifiers.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of all registered profile identifiers.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="k">def</span> <span class="nf">identifiers</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    List all registered profile identifiers.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        List of all registered profile identifiers.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">return</span> <span class="n">factory</span><span class="o">.</span><span class="n">registered_identifiers</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.core.load_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.core.load_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Thin wrapper around <code>xarray.load_dataset</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="os.PathLike">PathLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Thin wrapper around `xarray.load_dataset`.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        path: Path to the dataset.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        Profile.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.core.make" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interp_method</span><span class="o">=</span><span class="n">DEFAULT_METHOD</span><span class="p">,</span> <span class="n">conserve_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">molecules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">regularize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rescale_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_x_sum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.core.make" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a profile with the specified identifier.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>identifier</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile identifier.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>z</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span> | dict | <span title="xarray.DataArray">DataArray</span> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Altitude values.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>interp_method</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mapping of variable and interpolation method.</p>
            </div>
          </td>
          <td>
                <code><span title="joseki.profiles.core.DEFAULT_METHOD">DEFAULT_METHOD</span></code>
          </td>
        </tr>
        <tr>
          <td><code>conserve_column</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, ensure that column densities are conserved
during interpolation.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>molecules</code></td>
          <td>
                <code><span title="typing.List">List</span>[str] | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of molecules to include in the profile.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>regularize</code></td>
          <td>
                <code>bool | dict | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Regularize the altitude grid with specified options which
are passed to
<a href="./#src.joseki.profiles.core.regularize">regularize</a>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>rescale_to</code></td>
          <td>
                <code>dict | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Rescale molecular concentrations to the specified target
values which are passed to
<a href="./#src.joseki.accessor.JosekiAccessor.rescale_to">rescale_to</a>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>check_x_sum</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, check that the mole fraction sums are less or
equal to 1.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments passed to the profile constructor.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile as xarray.Dataset.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="see-also" open>
  <summary>See Also</summary>
  <p><a href="./#src.joseki.profiles.core.regularize">regularize</a>
<a href="./#src.joseki.accessor.JosekiAccessor.rescale_to">rescale_to</a></p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">z</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">interp_method</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">DEFAULT_METHOD</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">conserve_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">molecules</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">regularize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">rescale_to</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">check_x_sum</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Create a profile with the specified identifier.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        identifier: Profile identifier.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        z: Altitude values.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        interp_method: Mapping of variable and interpolation method.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        conserve_column: If `True`, ensure that column densities are conserved</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            during interpolation.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        molecules: List of molecules to include in the profile.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        regularize: Regularize the altitude grid with specified options which</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            are passed to</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            [regularize](reference.md#src.joseki.profiles.core.regularize).</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        rescale_to: Rescale molecular concentrations to the specified target</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            values which are passed to</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            [rescale_to](reference.md#src.joseki.accessor.JosekiAccessor.rescale_to).</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        check_x_sum: If `True`, check that the mole fraction sums are less or</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            equal to 1.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        kwargs: Additional keyword arguments passed to the profile constructor.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        Profile as xarray.Dataset.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    See Also:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        [regularize](reference.md#src.joseki.profiles.core.regularize)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        [rescale_to](reference.md#src.joseki.accessor.JosekiAccessor.rescale_to)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating profile </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;z: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;interp_method: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">interp_method</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;conserve_column: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">conserve_column</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;molecules: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">molecules</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;regularize: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">regularize</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;rescale_to: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rescale_to</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;kwargs: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="c1"># Convert z to pint.Quantity</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">profile</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;exporting profile to xarray.Dataset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">interp_method</span><span class="o">=</span><span class="n">interp_method</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">conserve_column</span><span class="o">=</span><span class="n">conserve_column</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># Molecules selection</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">if</span> <span class="n">molecules</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">select_molecules</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">molecules</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="c1"># Altitude grid regularization</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">if</span> <span class="n">regularize</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">to_quantity</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">default_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">z</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">z</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">//</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regularize</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">regularize</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">_regularize</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="n">method</span><span class="o">=</span><span class="n">regularize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">DEFAULT_METHOD</span><span class="p">),</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">conserve_column</span><span class="o">=</span><span class="n">regularize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conserve_column&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="n">options</span><span class="o">=</span><span class="n">regularize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num&quot;</span><span class="p">:</span> <span class="n">default_num</span><span class="p">}),</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="c1"># Molecular concentration rescaling</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">if</span> <span class="n">rescale_to</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">joseki</span><span class="o">.</span><span class="n">rescale_to</span><span class="p">(</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">target</span><span class="o">=</span><span class="n">rescale_to</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">check_x_sum</span><span class="o">=</span><span class="n">check_x_sum</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">return</span> <span class="n">ds</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.core.merge" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">new_title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#joseki.core.merge" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Merge multiple profiles into a single profile.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>datasets</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<span title="xarray.Dataset">Dataset</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable of profiles.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>new_title</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New title for the merged profile. If <code>None</code>, the title of
the first profile is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Merged profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The first profile in the iterable is used as the base profile; when
variables with the same name are encountered in subsequent profiles,
the variable from the first profile is used.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">datasets</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">],</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">new_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    Merge multiple profiles into a single profile.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        datasets: Iterable of profiles.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        new_title: New title for the merged profile. If `None`, the title of</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            the first profile is used.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        Merged profile.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        The first profile in the iterable is used as the base profile; when</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        variables with the same name are encountered in subsequent profiles,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        the variable from the first profile is used.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">merged</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">datasets</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;override&quot;</span><span class="p">,</span>  <span class="c1"># pick variable from first dataset</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">combine_attrs</span><span class="o">=</span><span class="s2">&quot;override&quot;</span><span class="p">,</span>  <span class="c1"># copy attrs from the first dataset to the result</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># update attributes</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">institutions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;institution&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">])</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">sources</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">])</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">references</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;references&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">])</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">urls</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">])</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">urldates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;urldate&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">])</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">conventions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;Conventions&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">])</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">with_profiles</span> <span class="o">=</span> <span class="s2">&quot;with profile &quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="s2">&quot;with profiles &quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">with_profiles</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">ds</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&#39;&quot;</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;history&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s2"> - merged profile &#39;</span><span class="si">{</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&#39; </span><span class="si">{</span><span class="n">with_profiles</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="sa">f</span><span class="s2">&quot;joseki, version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;institution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">institutions</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;references&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">references</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;urldate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">urldates</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;Conventions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">conventions</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">if</span> <span class="n">new_title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_title</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">merged</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">return</span> <span class="n">merged</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.core.open_dataset" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#joseki.core.open_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Thin wrapper around <code>xarray.open_dataset</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span title="os.PathLike">PathLike</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path to the dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Profile.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/core.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">def</span> <span class="nf">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Thin wrapper around `xarray.open_dataset`.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        path: Path to the dataset.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        Profile.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.units" class="doc doc-heading">
          <code>joseki.units</code>


<a href="#joseki.units" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Units module.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="joseki.units.to_quantity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">to_quantity</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#joseki.units.to_quantity" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Convert to a <code>pint.Quantity</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>value</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span> | dict | int | float | list | <span title="numpy.ndarray">ndarray</span> | <span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value which will be converted. If value is an <code>ArrayLike</code>, it is
assumed to be dimensionless (unless <code>units</code> is set).
If a <code>xarray.DataArray</code> is passed and
<code>units_error</code> is <code>True</code>, it is assumed to have a <code>units</code> key in
its <code>attrs</code> field; otherwise, it is assumed to be dimensionless.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>units</code></td>
          <td>
                <code>None | str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Units to assign. If <code>None</code>, the units are inferred from the
<code>value</code> argument.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The corresponding quantity.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>This function can also be used on DataArray and Dataset coordinate
variables.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/units.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="nd">@singledispatch</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">def</span> <span class="nf">to_quantity</span><span class="p">(</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">value</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">units</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to a `pint.Quantity`.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        value: Value which will be converted. If value is an `ArrayLike`, it is</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            assumed to be dimensionless (unless `units` is set).</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            If a `xarray.DataArray` is passed and</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            `units_error` is `True`, it is assumed to have a `units` key in</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            its `attrs` field; otherwise, it is assumed to be dimensionless.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        units: Units to assign. If `None`, the units are inferred from the</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            `value` argument.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        The corresponding quantity.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        This function can also be used on DataArray and Dataset coordinate</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        variables.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




<h2 id="joseki.profiles.util" class="doc doc-heading">
          <code>joseki.profiles.util</code>


<a href="#joseki.profiles.util" class="headerlink" title="Permanent link">&para;</a></h2>

  <div class="doc doc-contents first">
  
      <p>Utility module.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.util.air_molar_mass_from_mass_fraction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">air_molar_mass_from_mass_fraction</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>

<a href="#joseki.profiles.util.air_molar_mass_from_mass_fraction" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute the air molar mass from the of air constituents mass fractions.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mass fraction as a function of molecule (<code>m</code>) and altitude (<code>z</code>).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="xarray.DataArray">DataArray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air molar mass as a function of altitude (<code>z</code>).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The air molar mass is computed according to the following equation:</p>
<div class="arithmatex">\[
m_{\mathrm{air}} (z) = \left(
    \sum_{\mathrm{M}} \frac{
        y_{\mathrm{M}} (z)
    }{
        m_{\mathrm{M}}
    }
\right)^{-1}
\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(y_{\mathrm{M}} (z)\)</span> is the mass fraction of molecule M at altitude
  <span class="arithmatex">\(z\)</span>,</li>
<li><span class="arithmatex">\(m_{\mathrm{M}}\)</span> is the molar mass of molecule M.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="k">def</span> <span class="nf">air_molar_mass_from_mass_fraction</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    Compute the air molar mass from the of air constituents mass fractions.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        y: Mass fraction as a function of molecule (`m`) and altitude (`z`).</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        Air molar mass as a function of altitude (`z`).</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        The air molar mass is computed according to the following equation:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        $$</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        m_{\mathrm{air}} (z) = \left(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            \sum_{\mathrm{M}} \frac{</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">                y_{\mathrm{M}} (z)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            }{</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">                m_{\mathrm{M}}</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            }</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        \right)^{-1}</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        $$</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        where:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        * $y_{\mathrm{M}} (z)$ is the mass fraction of molecule M at altitude</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">          $z$,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        * $m_{\mathrm{M}}$ is the molar mass of molecule M.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># compute molar masses along molecular species</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">molecules</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">mm</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">MM</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">],</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">molecules</span><span class="p">)},</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="c1"># compute air molar mass</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">mm_inv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">mm</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">weighted_mean_mm_inv</span> <span class="o">=</span> <span class="p">(</span><span class="n">mm_inv</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">mm_air</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">weighted_mean_mm_inv</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">mm_air</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;g/mol&quot;</span><span class="p">})</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">return</span> <span class="n">mm_air</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.util.number_density" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">number_density</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span></code>

<a href="#joseki.profiles.util.number_density" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute air number density from air pressure and air temperature.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>p</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air pressure.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>t</code></td>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Air temperature.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pint.Quantity">Quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number density.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The air number density is computed according to the ideal gas law:</p>
<div class="arithmatex">\[
n = \frac{p}{k_B T}
\]</div>
<p>where <span class="arithmatex">\(p\)</span> is the air pressure, <span class="arithmatex">\(k_B\)</span> is the Boltzmann constant, and
<span class="arithmatex">\(T\)</span> is the air temperature.</p>
</details>
          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span> <span class="nf">number_density</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute air number density from air pressure and air temperature.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        p: Air pressure.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        t: Air temperature.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        Number density.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        The air number density is computed according to the ideal gas law:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        $$</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        n = \\frac{p}{k_B T}</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        $$</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        where $p$ is the air pressure, $k_B$ is the Boltzmann constant, and</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        $T$ is the air temperature.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">K</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="joseki.profiles.util.utcnow" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">joseki</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span></code>

<a href="#joseki.profiles.util.utcnow" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get current UTC time.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ISO 8601 formatted UTC timestamp.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/joseki/profiles/util.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="k">def</span> <span class="nf">utcnow</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current UTC time.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        ISO 8601 formatted UTC timestamp.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight"], "search": "../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>